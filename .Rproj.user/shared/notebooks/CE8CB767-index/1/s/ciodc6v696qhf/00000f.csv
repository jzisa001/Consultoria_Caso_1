"0",""
"0",""
"0",""
"0","# StepCriterion"
"0",""
"0","#sc <- stepCriterion(gamma.reg, direction=""backward"", criterion=""aic"", test=""wald"")"
"0",""
"0","# Ajuste con stepAIC, guardando resultados intermedios"
"0",""
"0","# Forward"
"0","gamma.reg_null <- glm(Talla ~ 1, family= Gamma(),data = datos)"
"0",""
"0","gamma.reg <- glm(Talla ~ LRT_A + LRT_CM + LRM_90 + LRM_R + Edad + Etnia + Peso + Sexo + Programa, family= Gamma(),data = datos)"
"0","summary(gamma.reg)"
"1","
Call:
"
"1",""
"1","glm(formula = Talla ~ LRT_A + LRT_CM + LRM_90 + LRM_R + Edad + 
    Etnia + Peso + Sexo + Programa, family = Gamma(), data = datos)"
"1",""
"1","
"
"1","
Coefficients:
"
"1","                            "
"1","   Estimate"
"1"," Std. Error"
"1"," t value"
"1"," Pr(>|t|)"
"1","    "
"1","
(Intercept)                 "
"1","  1.051e-02"
"1","  1.381e-04"
"1","  76.061"
"1","  < 2e-16"
"1"," ***"
"1","
LRT_A                       "
"1"," -5.906e-05"
"1","  9.130e-06"
"1","  -6.469"
"1"," 2.20e-10"
"1"," ***"
"1","
LRT_CM                      "
"1"," -1.917e-05"
"1","  8.782e-06"
"1","  -2.183"
"1","  0.02944"
"1"," *  "
"1","
LRM_90                      "
"1","  1.307e-05"
"1","  7.322e-06"
"1","   1.786"
"1","  0.07469"
"1"," .  "
"1","
LRM_R                       "
"1"," -2.381e-05"
"1","  7.423e-06"
"1","  -3.208"
"1","  0.00142"
"1"," ** "
"1","
Edad                        "
"1","  4.866e-06"
"1","  8.823e-07"
"1","   5.516"
"1"," 5.37e-08"
"1"," ***"
"1","
EtniaBlanco-Mestizo         "
"1"," -1.184e-04"
"1","  5.921e-05"
"1","  -2.001"
"1","  0.04594"
"1"," *  "
"1","
EtniaIndigena               "
"1"," -1.722e-04"
"1","  7.931e-05"
"1","  -2.171"
"1","  0.03034"
"1"," *  "
"1","
EtniaRrom                   "
"1"," -1.542e-04"
"1","  1.373e-04"
"1","  -1.123"
"1","  0.26189"
"1","    "
"1","
Peso                        "
"1"," -7.564e-07"
"1","  6.366e-07"
"1","  -1.188"
"1","  0.23527"
"1","    "
"1","
SexoMasculino               "
"1"," -1.319e-04"
"1","  1.646e-05"
"1","  -8.013"
"1"," 6.80e-15"
"1"," ***"
"1","
ProgramaComunidad de Cuidado"
"1","  4.059e-06"
"1","  1.338e-05"
"1","   0.303"
"1","  0.76177"
"1","    "
"1","
"
"1","---
Signif. codes:  "
"1",""
"1","0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1"
"1","
"
"1","
(Dispersion parameter for "
"1",""
"1","Gamma"
"1",""
"1"," family taken to be "
"1",""
"1","0.0004385946"
"1",""
"1",")

"
"1",""
"1","    Null deviance: 2.07361  on 557  degrees of freedom
"
"1",""
"1","Residual deviance: 0.24035  on 546  degrees of freedom
"
"1","AIC: "
"1",""
"1","2918.3"
"1",""
"1","

"
"1",""
"1","Number of Fisher Scoring iterations: "
"1",""
"1","3"
"1",""
"1","
"
"1","
"
"0","stepwise <- stepAIC(gamma.reg_null, scope = list(lower = gamma.reg_null, upper = gamma.reg), trace = TRUE, k= 2, direction=""forward"") # k= log(nrow(datos)) - BIC"
"1","Start:  AIC="
"1",""
"1","4099.02"
"1",""
"1","
"
"1",""
"1","Talla ~ 1"
"1",""
"1","

"
"1","          "
"1"," Df"
"1"," Deviance"
"1","    AIC"
"1","
+ LRT_A   "
"1","  1"
"1","  0.28728"
"1"," 3620.5"
"1","
+ LRT_CM  "
"1","  1"
"1","  0.35344"
"1"," 3638.3"
"1","
+ LRM_R   "
"1","  1"
"1","  0.35989"
"1"," 3640.0"
"1","
+ LRM_90  "
"1","  1"
"1","  0.44295"
"1"," 3662.4"
"1","
+ Sexo    "
"1","  1"
"1","  0.98418"
"1"," 3808.0"
"1","
+ Peso    "
"1","  1"
"1","  1.55525"
"1"," 3961.6"
"1","
<none>    "
"1","   "
"1","  2.07361"
"1"," 4099.0"
"1","
+ Etnia   "
"1","  3"
"1","  2.05507"
"1"," 4100.0"
"1","
+ Programa"
"1","  1"
"1","  2.07331"
"1"," 4100.9"
"1","
+ Edad    "
"1","  1"
"1","  2.07358"
"1"," 4101.0"
"1","
"
"1","
Step:  AIC="
"1",""
"1","2997.77"
"1",""
"1","
"
"1",""
"1","Talla ~ LRT_A"
"1",""
"1","

"
"1","          "
"1"," Df"
"1"," Deviance"
"1","    AIC"
"1","
+ Sexo    "
"1","  1"
"1","  0.26383"
"1"," 2954.2"
"1","
+ Edad    "
"1","  1"
"1","  0.27901"
"1"," 2983.7"
"1","
+ LRM_R   "
"1","  1"
"1","  0.28216"
"1"," 2989.8"
"1","
<none>    "
"1","   "
"1","  0.28728"
"1"," 2997.8"
"1","
+ LRT_CM  "
"1","  1"
"1","  0.28638"
"1"," 2998.0"
"1","
+ Peso    "
"1","  1"
"1","  0.28685"
"1"," 2998.9"
"1","
+ Programa"
"1","  1"
"1","  0.28694"
"1"," 2999.1"
"1","
+ LRM_90  "
"1","  1"
"1","  0.28725"
"1"," 2999.7"
"1","
+ Etnia   "
"1","  3"
"1","  0.28578"
"1"," 3000.9"
"1","
"
"1","
Step:  AIC="
"1",""
"1","2952.27"
"1",""
"1","
"
"1",""
"1","Talla ~ LRT_A + Sexo"
"1",""
"1","

"
"1","          "
"1"," Df"
"1"," Deviance"
"1","    AIC"
"1","
+ Edad    "
"1","  1"
"1","  0.25000"
"1"," 2925.1"
"1","
+ LRM_R   "
"1","  1"
"1","  0.26006"
"1"," 2946.3"
"1","
+ Peso    "
"1","  1"
"1","  0.26168"
"1"," 2949.7"
"1","
+ LRT_CM  "
"1","  1"
"1","  0.26194"
"1"," 2950.3"
"1","
<none>    "
"1","   "
"1","  0.26383"
"1"," 2952.3"
"1","
+ Programa"
"1","  1"
"1","  0.26299"
"1"," 2952.5"
"1","
+ LRM_90  "
"1","  1"
"1","  0.26344"
"1"," 2953.4"
"1","
+ Etnia   "
"1","  3"
"1","  0.26227"
"1"," 2955.0"
"1","
"
"1","
Step:  AIC="
"1",""
"1","2924.23"
"1",""
"1","
"
"1",""
"1","Talla ~ LRT_A + Sexo + Edad"
"1",""
"1","

"
"1","          "
"1"," Df"
"1"," Deviance"
"1","    AIC"
"1","
+ LRM_R   "
"1","  1"
"1","  0.24628"
"1"," 2917.9"
"1","
+ LRT_CM  "
"1","  1"
"1","  0.24773"
"1"," 2921.2"
"1","
<none>    "
"1","   "
"1","  0.25000"
"1"," 2924.2"
"1","
+ Peso    "
"1","  1"
"1","  0.24946"
"1"," 2925.0"
"1","
+ Etnia   "
"1","  3"
"1","  0.24769"
"1"," 2925.1"
"1","
+ Programa"
"1","  1"
"1","  0.24950"
"1"," 2925.1"
"1","
+ LRM_90  "
"1","  1"
"1","  0.24982"
"1"," 2925.8"
"1","
"
"1","
Step:  AIC="
"1",""
"1","2917.85"
"1",""
"1","
"
"1",""
"1","Talla ~ LRT_A + Sexo + Edad + LRM_R"
"1",""
"1","

"
"1","          "
"1"," Df"
"1"," Deviance"
"1","    AIC"
"1","
+ LRT_CM  "
"1","  1"
"1","  0.24473"
"1"," 2916.3"
"1","
+ Peso    "
"1","  1"
"1","  0.24506"
"1"," 2917.1"
"1","
<none>    "
"1","   "
"1","  0.24628"
"1"," 2917.8"
"1","
+ Etnia   "
"1","  3"
"1","  0.24381"
"1"," 2918.3"
"1","
+ LRM_90  "
"1","  1"
"1","  0.24613"
"1"," 2919.5"
"1","
+ Programa"
"1","  1"
"1","  0.24614"
"1"," 2919.5"
"1","
"
"1","
Step:  AIC="
"1",""
"1","2916.32"
"1",""
"1","
"
"1",""
"1","Talla ~ LRT_A + Sexo + Edad + LRM_R + LRT_CM"
"1",""
"1","

"
"1","          "
"1"," Df"
"1"," Deviance"
"1","    AIC"
"1","
+ LRM_90  "
"1","  1"
"1","  0.24367"
"1"," 2915.9"
"1","
<none>    "
"1","   "
"1","  0.24473"
"1"," 2916.3"
"1","
+ Peso    "
"1","  1"
"1","  0.24391"
"1"," 2916.5"
"1","
+ Etnia   "
"1","  3"
"1","  0.24240"
"1"," 2917.1"
"1","
+ Programa"
"1","  1"
"1","  0.24456"
"1"," 2917.9"
"1","
"
"1","
Step:  AIC="
"1",""
"1","2915.91"
"1",""
"1","
"
"1",""
"1","Talla ~ LRT_A + Sexo + Edad + LRM_R + LRT_CM + LRM_90"
"1",""
"1","

"
"1","          "
"1"," Df"
"1"," Deviance"
"1","    AIC"
"1","
+ Peso    "
"1","  1"
"1","  0.24270"
"1"," 2915.7"
"1","
<none>    "
"1","   "
"1","  0.24367"
"1"," 2915.9"
"1","
+ Etnia   "
"1","  3"
"1","  0.24117"
"1"," 2916.2"
"1","
+ Programa"
"1","  1"
"1","  0.24340"
"1"," 2917.3"
"1","
"
"1","
Step:  AIC="
"1",""
"1","2915.67"
"1",""
"1","
"
"1",""
"1","Talla ~ LRT_A + Sexo + Edad + LRM_R + LRT_CM + LRM_90 + Peso"
"1",""
"1","

"
"1","          "
"1"," Df"
"1"," Deviance"
"1","    AIC"
"1","
<none>    "
"1","   "
"1","  0.24270"
"1"," 2915.7"
"1","
+ Etnia   "
"1","  3"
"1","  0.24039"
"1"," 2916.4"
"1","
+ Programa"
"1","  1"
"1","  0.24263"
"1"," 2917.5"
"1","
"
"0","modelos_intermedios <- list()"
"0",""
"0","# Función para guardar modelos en cada paso"
"0","guardar_modelos <- function(object, ...) {"
"0","  modelos_intermedios[[length(modelos_intermedios) + 1]] <<- object"
"0","  FALSE  # Devuelve FALSE para continuar con el proceso"
"0","}"
"0",""
"0","# Selección hacia adelante con BIC y almacenamiento de modelos intermedios"
"0","stepwise <- stepAIC("
"0","  gamma.reg_null,"
"0","  scope = list(lower = gamma.reg_null, upper = gamma.reg),"
"0","  direction = ""forward"","
"0","  trace = TRUE,"
"0","  k = log(nrow(datos)),  # Usar BIC en lugar de AIC"
"0","  keep = guardar_modelos  # Guardar cada modelo intermedio"
"0",")"
"1","Start:  AIC="
"1",""
"1","4103.34"
"1",""
"1","
"
"1",""
"1","Talla ~ 1"
"1",""
"1","

"
"1","          "
"1"," Df"
"1"," Deviance"
"1","    AIC"
"1","
+ LRT_A   "
"1","  1"
"1","  0.28728"
"1"," 3629.1"
"1","
+ LRT_CM  "
"1","  1"
"1","  0.35344"
"1"," 3646.9"
"1","
+ LRM_R   "
"1","  1"
"1","  0.35989"
"1"," 3648.7"
"1","
+ LRM_90  "
"1","  1"
"1","  0.44295"
"1"," 3671.0"
"1","
+ Sexo    "
"1","  1"
"1","  0.98418"
"1"," 3816.6"
"1","
+ Peso    "
"1","  1"
"1","  1.55525"
"1"," 3970.2"
"1","
<none>    "
"1","   "
"1","  2.07361"
"1"," 4103.3"
"1","
+ Programa"
"1","  1"
"1","  2.07331"
"1"," 4109.6"
"1","
+ Edad    "
"1","  1"
"1","  2.07358"
"1"," 4109.7"
"1","
+ Etnia   "
"1","  3"
"1","  2.05507"
"1"," 4117.3"
"1","
"
"1","
Step:  AIC="
"1",""
"1","3006.42"
"1",""
"1","
"
"1",""
"1","Talla ~ LRT_A"
"1",""
"1","

"
"1","          "
"1"," Df"
"1"," Deviance"
"1","    AIC"
"1","
+ Sexo    "
"1","  1"
"1","  0.26383"
"1"," 2967.2"
"1","
+ Edad    "
"1","  1"
"1","  0.27901"
"1"," 2996.7"
"1","
+ LRM_R   "
"1","  1"
"1","  0.28216"
"1"," 3002.8"
"1","
<none>    "
"1","   "
"1","  0.28728"
"1"," 3006.4"
"1","
+ LRT_CM  "
"1","  1"
"1","  0.28638"
"1"," 3011.0"
"1","
+ Peso    "
"1","  1"
"1","  0.28685"
"1"," 3011.9"
"1","
+ Programa"
"1","  1"
"1","  0.28694"
"1"," 3012.1"
"1","
+ LRM_90  "
"1","  1"
"1","  0.28725"
"1"," 3012.7"
"1","
+ Etnia   "
"1","  3"
"1","  0.28578"
"1"," 3022.5"
"1","
"
"1","
Step:  AIC="
"1",""
"1","2965.24"
"1",""
"1","
"
"1",""
"1","Talla ~ LRT_A + Sexo"
"1",""
"1","

"
"1","          "
"1"," Df"
"1"," Deviance"
"1","    AIC"
"1","
+ Edad    "
"1","  1"
"1","  0.25000"
"1"," 2942.4"
"1","
+ LRM_R   "
"1","  1"
"1","  0.26006"
"1"," 2963.6"
"1","
<none>    "
"1","   "
"1","  0.26383"
"1"," 2965.2"
"1","
+ Peso    "
"1","  1"
"1","  0.26168"
"1"," 2967.0"
"1","
+ LRT_CM  "
"1","  1"
"1","  0.26194"
"1"," 2967.6"
"1","
+ Programa"
"1","  1"
"1","  0.26299"
"1"," 2969.8"
"1","
+ LRM_90  "
"1","  1"
"1","  0.26344"
"1"," 2970.7"
"1","
+ Etnia   "
"1","  3"
"1","  0.26227"
"1"," 2980.9"
"1","
"
"1","
Step:  AIC="
"1",""
"1","2941.52"
"1",""
"1","
"
"1",""
"1","Talla ~ LRT_A + Sexo + Edad"
"1",""
"1","

"
"1","          "
"1"," Df"
"1"," Deviance"
"1","    AIC"
"1","
+ LRM_R   "
"1","  1"
"1","  0.24628"
"1"," 2939.6"
"1","
<none>    "
"1","   "
"1","  0.25000"
"1"," 2941.5"
"1","
+ LRT_CM  "
"1","  1"
"1","  0.24773"
"1"," 2942.8"
"1","
+ Peso    "
"1","  1"
"1","  0.24946"
"1"," 2946.7"
"1","
+ Programa"
"1","  1"
"1","  0.24950"
"1"," 2946.7"
"1","
+ LRM_90  "
"1","  1"
"1","  0.24982"
"1"," 2947.4"
"1","
+ Etnia   "
"1","  3"
"1","  0.24769"
"1"," 2955.4"
"1","
"
"1","
Step:  AIC="
"1",""
"1","2939.47"
"1",""
"1","
"
"1",""
"1","Talla ~ LRT_A + Sexo + Edad + LRM_R"
"1",""
"1","

"
"1","          "
"1"," Df"
"1"," Deviance"
"1","    AIC"
"1","
<none>    "
"1","   "
"1","  0.24628"
"1"," 2939.5"
"1","
+ LRT_CM  "
"1","  1"
"1","  0.24473"
"1"," 2942.3"
"1","
+ Peso    "
"1","  1"
"1","  0.24506"
"1"," 2943.1"
"1","
+ LRM_90  "
"1","  1"
"1","  0.24613"
"1"," 2945.4"
"1","
+ Programa"
"1","  1"
"1","  0.24614"
"1"," 2945.5"
"1","
+ Etnia   "
"1","  3"
"1","  0.24381"
"1"," 2952.9"
"1","
"
"0","forms_gamma <- lapply(modelos_intermedios, formula)"
"0","#forms_gamma"
"0",""
"0",""
"0","#kfolds"
"0","best.fit <- pred <- CV.ERRORS <- cv.errors <- NULL"
"0",""
"0","k = 10"
"0","for (j in 1:k) {"
"0","  best.fit <- lapply(forms_gamma, function(formula){"
"0","    glm(formula, family = Gamma(), data = datos[folds != j, ])"
"0","})"
"0","  #for (i in 1:length(forms_gamma)) {"
"0","    pred <- lapply(best.fit, function(model){"
"0","      predict(model, datos[folds == j, ], type = ""response"")"
"0","      })"
"0","    cv.errors <- lapply(pred, function(coefs){"
"0","       mean((datos$Talla[folds == j] - coefs)^2)"
"0","    })"
"0","    cv.errors <- as.data.frame(cv.errors)"
"0","    colnames(cv.errors) <- c(paste(""Mod"", 1:length(forms_gamma)))"
"0","    CV.ERRORS <- rbind(CV.ERRORS, cv.errors)"
"0","  #}"
"0","}"
"2","Error in eval(f) : 'list' object cannot be coerced to type 'integer'
"
