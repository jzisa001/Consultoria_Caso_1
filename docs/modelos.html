<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>modelos</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "Ninguna coincidencia",
    "search-matching-documents-text": "coincidencias",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "",
    "search-label": "Search"
  }
}</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="./index.html"> 
<span class="menu-text">Inicio</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./descriptivo.html"> 
<span class="menu-text">Análisis descriptivo</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./hipotesis.html"> 
<span class="menu-text">Evaluación de hipótesis</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link active" href="./modelos.html" aria-current="page"> 
<span class="menu-text">Modelos</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Tabla de contenido</h2>
   
  <ul>
  <li><a href="#modelos" id="toc-modelos" class="nav-link active" data-scroll-target="#modelos">Modelos</a>
  <ul class="collapse">
  <li><a href="#lectura-de-datos" id="toc-lectura-de-datos" class="nav-link" data-scroll-target="#lectura-de-datos">Lectura de datos</a></li>
  <li><a href="#selección-del-mejor-modelo-usando-lrt_a" id="toc-selección-del-mejor-modelo-usando-lrt_a" class="nav-link" data-scroll-target="#selección-del-mejor-modelo-usando-lrt_a">Selección del mejor modelo usando LRT_A</a></li>
  <li><a href="#modelo-normal" id="toc-modelo-normal" class="nav-link" data-scroll-target="#modelo-normal">Modelo normal</a>
  <ul class="collapse">
  <li><a href="#lrt-antropómetro" id="toc-lrt-antropómetro" class="nav-link" data-scroll-target="#lrt-antropómetro">LRT Antropómetro</a></li>
  <li><a href="#lrt-cinta-métrica" id="toc-lrt-cinta-métrica" class="nav-link" data-scroll-target="#lrt-cinta-métrica">LRT cinta métrica</a></li>
  <li><a href="#lrm-pierna-estirada" id="toc-lrm-pierna-estirada" class="nav-link" data-scroll-target="#lrm-pierna-estirada">LRM pierna estirada</a></li>
  <li><a href="#lrm-pierna-a-90" id="toc-lrm-pierna-a-90" class="nav-link" data-scroll-target="#lrm-pierna-a-90">LRM pierna a 90°</a></li>
  </ul></li>
  <li><a href="#modelo-lasso" id="toc-modelo-lasso" class="nav-link" data-scroll-target="#modelo-lasso">Modelo Lasso</a></li>
  <li><a href="#lasso-sin-tener-en-cuenta-lrt_a" id="toc-lasso-sin-tener-en-cuenta-lrt_a" class="nav-link" data-scroll-target="#lasso-sin-tener-en-cuenta-lrt_a">Lasso sin tener en cuenta LRT_A</a></li>
  <li><a href="#modelo-lasso-1" id="toc-modelo-lasso-1" class="nav-link" data-scroll-target="#modelo-lasso-1">Modelo Lasso</a>
  <ul class="collapse">
  <li><a href="#lrt-antropómetro-1" id="toc-lrt-antropómetro-1" class="nav-link" data-scroll-target="#lrt-antropómetro-1">LRT Antropómetro</a></li>
  <li><a href="#lrt-cinta-métrica-1" id="toc-lrt-cinta-métrica-1" class="nav-link" data-scroll-target="#lrt-cinta-métrica-1">LRT cinta métrica</a></li>
  <li><a href="#lrm-pierna-estirada-1" id="toc-lrm-pierna-estirada-1" class="nav-link" data-scroll-target="#lrm-pierna-estirada-1">LRM pierna estirada</a></li>
  <li><a href="#lrm-pierna-a-90-1" id="toc-lrm-pierna-a-90-1" class="nav-link" data-scroll-target="#lrm-pierna-a-90-1">LRM pierna a 90°</a></li>
  </ul></li>
  <li><a href="#modelo-gamma" id="toc-modelo-gamma" class="nav-link" data-scroll-target="#modelo-gamma">Modelo Gamma</a></li>
  <li><a href="#modelo-gamma-1" id="toc-modelo-gamma-1" class="nav-link" data-scroll-target="#modelo-gamma-1">Modelo Gamma</a>
  <ul class="collapse">
  <li><a href="#lrt-antropómetro-2" id="toc-lrt-antropómetro-2" class="nav-link" data-scroll-target="#lrt-antropómetro-2">LRT Antropómetro</a></li>
  <li><a href="#lrt-cinta-métrica-2" id="toc-lrt-cinta-métrica-2" class="nav-link" data-scroll-target="#lrt-cinta-métrica-2">LRT cinta métrica</a></li>
  <li><a href="#lrm-pierna-estirada-2" id="toc-lrm-pierna-estirada-2" class="nav-link" data-scroll-target="#lrm-pierna-estirada-2">LRM pierna estirada</a></li>
  <li><a href="#lrm-pierna-90" id="toc-lrm-pierna-90" class="nav-link" data-scroll-target="#lrm-pierna-90">LRM pierna 90°</a></li>
  </ul></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">




<section id="modelos" class="level1">
<h1>Modelos</h1>
<section id="lectura-de-datos" class="level2">
<h2 class="anchored" data-anchor-id="lectura-de-datos">Lectura de datos</h2>
<p>Se muestra a continuación la forma que tienen los datos.</p>
<div class="cell">
<div class="cell-output-display">
<div id="sugipgcemk" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>@import url("https://fonts.googleapis.com/css2?family=Chivo:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap");
@import url("https://fonts.googleapis.com/css2?family=Chivo:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap");
@import url("https://fonts.googleapis.com/css2?family=Chivo:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap");
@import url("https://fonts.googleapis.com/css2?family=Cairo:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap");
#sugipgcemk table {
  font-family: Cairo, system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#sugipgcemk thead, #sugipgcemk tbody, #sugipgcemk tfoot, #sugipgcemk tr, #sugipgcemk td, #sugipgcemk th {
  border-style: none;
}

#sugipgcemk p {
  margin: 0;
  padding: 0;
}

#sugipgcemk .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 9px;
  font-weight: 400;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: none;
  border-top-width: 3px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#sugipgcemk .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#sugipgcemk .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#sugipgcemk .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#sugipgcemk .gt_heading {
  background-color: #FFFFFF;
  text-align: left;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#sugipgcemk .gt_bottom_border {
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#sugipgcemk .gt_col_headings {
  border-top-style: none;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #000000;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#sugipgcemk .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#sugipgcemk .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#sugipgcemk .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#sugipgcemk .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#sugipgcemk .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #000000;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#sugipgcemk .gt_spanner_row {
  border-bottom-style: hidden;
}

#sugipgcemk .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: none;
  border-top-width: 2px;
  border-top-color: #000000;
  border-bottom-style: solid;
  border-bottom-width: 1px;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#sugipgcemk .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: none;
  border-top-width: 2px;
  border-top-color: #000000;
  border-bottom-style: solid;
  border-bottom-width: 1px;
  border-bottom-color: #FFFFFF;
  vertical-align: middle;
}

#sugipgcemk .gt_from_md > :first-child {
  margin-top: 0;
}

#sugipgcemk .gt_from_md > :last-child {
  margin-bottom: 0;
}

#sugipgcemk .gt_row {
  padding-top: 3px;
  padding-bottom: 3px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#sugipgcemk .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 0px;
  border-right-color: #FFFFFF;
  padding-left: 5px;
  padding-right: 5px;
}

#sugipgcemk .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#sugipgcemk .gt_row_group_first td {
  border-top-width: 2px;
}

#sugipgcemk .gt_row_group_first th {
  border-top-width: 2px;
}

#sugipgcemk .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#sugipgcemk .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#sugipgcemk .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#sugipgcemk .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#sugipgcemk .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#sugipgcemk .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#sugipgcemk .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#sugipgcemk .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#sugipgcemk .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#sugipgcemk .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#sugipgcemk .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#sugipgcemk .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#sugipgcemk .gt_sourcenote {
  font-size: 12px;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#sugipgcemk .gt_left {
  text-align: left;
}

#sugipgcemk .gt_center {
  text-align: center;
}

#sugipgcemk .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#sugipgcemk .gt_font_normal {
  font-weight: normal;
}

#sugipgcemk .gt_font_bold {
  font-weight: bold;
}

#sugipgcemk .gt_font_italic {
  font-style: italic;
}

#sugipgcemk .gt_super {
  font-size: 65%;
}

#sugipgcemk .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#sugipgcemk .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#sugipgcemk .gt_indent_1 {
  text-indent: 5px;
}

#sugipgcemk .gt_indent_2 {
  text-indent: 10px;
}

#sugipgcemk .gt_indent_3 {
  text-indent: 15px;
}

#sugipgcemk .gt_indent_4 {
  text-indent: 20px;
}

#sugipgcemk .gt_indent_5 {
  text-indent: 25px;
}

#sugipgcemk .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#sugipgcemk div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}

tbody tr:last-child {
  border-bottom: 2px solid #ffffff00;
}
</style>

<table class="gt_table caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<thead>
<tr class="header gt_col_headings">
<th id="Fecha" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" style="border-top-width: 0px; border-top-style: solid; border-top-color: black; font-family: Chivo; font-size: 14px; vertical-align: bottom; font-weight: 200; text-transform: uppercase" scope="col">Fecha</th>
<th id="Localidad" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" style="border-top-width: 0px; border-top-style: solid; border-top-color: black; font-family: Chivo; font-size: 14px; vertical-align: bottom; font-weight: 200; text-transform: uppercase" scope="col">Localidad</th>
<th id="Programa" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" style="border-top-width: 0px; border-top-style: solid; border-top-color: black; font-family: Chivo; font-size: 14px; vertical-align: bottom; font-weight: 200; text-transform: uppercase" scope="col">Programa</th>
<th id="Unidad_atencion" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" style="border-top-width: 0px; border-top-style: solid; border-top-color: black; font-family: Chivo; font-size: 14px; vertical-align: bottom; font-weight: 200; text-transform: uppercase" scope="col">Unidad_atencion</th>
<th id="Sexo" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" style="border-top-width: 0px; border-top-style: solid; border-top-color: black; font-family: Chivo; font-size: 14px; vertical-align: bottom; font-weight: 200; text-transform: uppercase" scope="col">Sexo</th>
<th id="Edad" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" style="border-top-width: 0px; border-top-style: solid; border-top-color: black; font-family: Chivo; font-size: 14px; vertical-align: bottom; font-weight: 200; text-transform: uppercase" scope="col">Edad</th>
<th id="Etnia" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" style="border-top-width: 0px; border-top-style: solid; border-top-color: black; font-family: Chivo; font-size: 14px; vertical-align: bottom; font-weight: 200; text-transform: uppercase" scope="col">Etnia</th>
<th id="Peso" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" style="border-top-width: 0px; border-top-style: solid; border-top-color: black; font-family: Chivo; font-size: 14px; vertical-align: bottom; font-weight: 200; text-transform: uppercase" scope="col">Peso</th>
<th id="Talla" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" style="border-top-width: 0px; border-top-style: solid; border-top-color: black; font-family: Chivo; font-size: 14px; vertical-align: bottom; font-weight: 200; text-transform: uppercase" scope="col">Talla</th>
<th id="LRT_CM" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" style="border-top-width: 0px; border-top-style: solid; border-top-color: black; font-family: Chivo; font-size: 14px; vertical-align: bottom; font-weight: 200; text-transform: uppercase" scope="col">LRT_CM</th>
<th id="LRT_A" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" style="border-top-width: 0px; border-top-style: solid; border-top-color: black; font-family: Chivo; font-size: 14px; vertical-align: bottom; font-weight: 200; text-transform: uppercase" scope="col">LRT_A</th>
<th id="LRM_90" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" style="border-top-width: 0px; border-top-style: solid; border-top-color: black; font-family: Chivo; font-size: 14px; vertical-align: bottom; font-weight: 200; text-transform: uppercase" scope="col">LRM_90</th>
<th id="LRM_R" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" style="border-top-width: 0px; border-top-style: solid; border-top-color: black; font-family: Chivo; font-size: 14px; vertical-align: bottom; font-weight: 200; text-transform: uppercase" scope="col">LRM_R</th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_right" headers="Fecha">2024-10-03</td>
<td class="gt_row gt_left" headers="Localidad">Ciudad Bolivar</td>
<td class="gt_row gt_left" headers="Programa">Centro Día Casa de la Sabiduría</td>
<td class="gt_row gt_left" headers="Unidad_atencion">Centro Día Casa de la Sabiduría Tejedores de Sueños</td>
<td class="gt_row gt_center" headers="Sexo">Masculino</td>
<td class="gt_row gt_right" headers="Edad">63</td>
<td class="gt_row gt_center" headers="Etnia">Blanco-Mestizo</td>
<td class="gt_row gt_right" headers="Peso">101.80</td>
<td class="gt_row gt_right" headers="Talla">177.00</td>
<td class="gt_row gt_right" headers="LRT_CM">57.50</td>
<td class="gt_row gt_right" headers="LRT_A">57.65</td>
<td class="gt_row gt_right" headers="LRM_90">52.00</td>
<td class="gt_row gt_right" headers="LRM_R">52.50</td>
</tr>
<tr class="even">
<td class="gt_row gt_right" headers="Fecha">2024-09-25</td>
<td class="gt_row gt_left" headers="Localidad">Ciudad Bolivar</td>
<td class="gt_row gt_left" headers="Programa">Centro Día Casa de la Sabiduría</td>
<td class="gt_row gt_left" headers="Unidad_atencion">Centro Día Casa de la Sabiduría Sierra Morena</td>
<td class="gt_row gt_center" headers="Sexo">Masculino</td>
<td class="gt_row gt_right" headers="Edad">77</td>
<td class="gt_row gt_center" headers="Etnia">Blanco-Mestizo</td>
<td class="gt_row gt_right" headers="Peso">98.70</td>
<td class="gt_row gt_right" headers="Talla">165.00</td>
<td class="gt_row gt_right" headers="LRT_CM">52.50</td>
<td class="gt_row gt_right" headers="LRT_A">51.20</td>
<td class="gt_row gt_right" headers="LRM_90">46.50</td>
<td class="gt_row gt_right" headers="LRM_R">45.00</td>
</tr>
<tr class="odd">
<td class="gt_row gt_right" headers="Fecha">2024-10-16</td>
<td class="gt_row gt_left" headers="Localidad">Engativa</td>
<td class="gt_row gt_left" headers="Programa">Centro Día Casa de la Sabiduría</td>
<td class="gt_row gt_left" headers="Unidad_atencion">Centro Día Casa de la Sabiduría Los Cerezos</td>
<td class="gt_row gt_center" headers="Sexo">Masculino</td>
<td class="gt_row gt_right" headers="Edad">78</td>
<td class="gt_row gt_center" headers="Etnia">Blanco-Mestizo</td>
<td class="gt_row gt_right" headers="Peso">97.65</td>
<td class="gt_row gt_right" headers="Talla">175.70</td>
<td class="gt_row gt_right" headers="LRT_CM">58.45</td>
<td class="gt_row gt_right" headers="LRT_A">56.90</td>
<td class="gt_row gt_right" headers="LRM_90">50.60</td>
<td class="gt_row gt_right" headers="LRM_R">51.35</td>
</tr>
<tr class="even">
<td class="gt_row gt_right" headers="Fecha">2024-09-23</td>
<td class="gt_row gt_left" headers="Localidad">Rafel Uribe</td>
<td class="gt_row gt_left" headers="Programa">Centro Día Casa de la Sabiduría</td>
<td class="gt_row gt_left" headers="Unidad_atencion">Centro Día Casa de la Sabiduría Palabras Mayores</td>
<td class="gt_row gt_center" headers="Sexo">Masculino</td>
<td class="gt_row gt_right" headers="Edad">74</td>
<td class="gt_row gt_center" headers="Etnia">Blanco-Mestizo</td>
<td class="gt_row gt_right" headers="Peso">97.40</td>
<td class="gt_row gt_right" headers="Talla">172.95</td>
<td class="gt_row gt_right" headers="LRT_CM">55.80</td>
<td class="gt_row gt_right" headers="LRT_A">54.10</td>
<td class="gt_row gt_right" headers="LRM_90">51.05</td>
<td class="gt_row gt_right" headers="LRM_R">49.00</td>
</tr>
<tr class="odd">
<td class="gt_row gt_right" headers="Fecha">2024-09-25</td>
<td class="gt_row gt_left" headers="Localidad">Ciudad Bolivar</td>
<td class="gt_row gt_left" headers="Programa">Centro Día Casa de la Sabiduría</td>
<td class="gt_row gt_left" headers="Unidad_atencion">Centro Día Casa de la Sabiduría Sierra Morena</td>
<td class="gt_row gt_center" headers="Sexo">Femenino</td>
<td class="gt_row gt_right" headers="Edad">70</td>
<td class="gt_row gt_center" headers="Etnia">Blanco-Mestizo</td>
<td class="gt_row gt_right" headers="Peso">97.10</td>
<td class="gt_row gt_right" headers="Talla">153.35</td>
<td class="gt_row gt_right" headers="LRT_CM">50.50</td>
<td class="gt_row gt_right" headers="LRT_A">49.45</td>
<td class="gt_row gt_right" headers="LRM_90">45.20</td>
<td class="gt_row gt_right" headers="LRM_R">43.10</td>
</tr>
<tr class="even">
<td class="gt_row gt_right" headers="Fecha">2024-09-09</td>
<td class="gt_row gt_left" headers="Localidad">Engativa</td>
<td class="gt_row gt_left" headers="Programa">Comunidad de Cuidado</td>
<td class="gt_row gt_left" headers="Unidad_atencion">Comunidad de Cuidado Bosque Popular</td>
<td class="gt_row gt_center" headers="Sexo">Masculino</td>
<td class="gt_row gt_right" headers="Edad">72</td>
<td class="gt_row gt_center" headers="Etnia">Blanco-Mestizo</td>
<td class="gt_row gt_right" headers="Peso">95.60</td>
<td class="gt_row gt_right" headers="Talla">174.40</td>
<td class="gt_row gt_right" headers="LRT_CM">56.70</td>
<td class="gt_row gt_right" headers="LRT_A">55.10</td>
<td class="gt_row gt_right" headers="LRM_90">50.85</td>
<td class="gt_row gt_right" headers="LRM_R">48.15</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>A continuación el resumen de la evaluación de las hipótesis de interés:</p>
<ul>
<li>La diferencia en las mediciones de LRT con antropómetro y con cinta métrica resultó ser estadísticamente significativa.</li>
<li>La diferencia en las mediciones de LRM con la pierna a <span class="math inline">\(90°\)</span> y la pierna estirada resultó ser estadísticamente significativa.</li>
</ul>
<p>Estos resultados sigieren que:</p>
<ul>
<li>No es posible determinar que las mediciones de LRT con la cinta métrica sean iguales a las obtenidas con antropómetro. Asumiendo que la medición con antropómetro es más exacta, las mediciones con la cinta métrica suelen sobreestimar en promedio a las del antropómetro.</li>
<li>Tampoco es posible determinar que las mediciones de LRM con la pierna a <span class="math inline">\(90°\)</span> y con la pierna estirada sean iguales. La medición con la pierna estirada suele ser en promedio menor a la medición hecha con la pierna a <span class="math inline">\(90°\)</span>.</li>
</ul>
<p>Los resultados obtenidos al evaluar las fórmulas de <strong><em>Benjumea</em></strong> y de <strong><em>Arango y Zamora</em></strong> en muestra de adultos mayores que atiende la SDIS, parecen no tener muy buenos resultados a la hora de estimar la talla de los adultos mayores.</p>
<p>Dado estos resultados, se concluye que se requiere de fórmulas específicas para la población que atiende la <strong>SDIS</strong>. Además, se deberá ajustar estos modelos para las cuatro mediciones pues la evaluación de las hipótesis no dieron indicios de la igualdad entre los métodos de las mediciones.</p>
</section>
<section id="selección-del-mejor-modelo-usando-lrt_a" class="level2">
<h2 class="anchored" data-anchor-id="selección-del-mejor-modelo-usando-lrt_a">Selección del mejor modelo usando LRT_A</h2>
<p>Inicialmente, se hará la selección del mejor modelo para LRT_A mediante un enfoque predictivo.</p>
<p>A continuación se hace una búsqueda del mejor modelo por cada número de posibles combinaciones de variables. Primero se hará la búsqueda usando todo el conjunto de datos.</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>Subset selection object
Call: regsubsets.formula(Talla ~ LRT_A + Peso + Edad + Sexo + Etnia + 
    Programa, datos, nbest = 1, nvmax = 10)
8 Variables  (and intercept)
                             Forced in Forced out
LRT_A                            FALSE      FALSE
Peso                             FALSE      FALSE
Edad                             FALSE      FALSE
SexoMasculino                    FALSE      FALSE
EtniaBlanco-Mestizo              FALSE      FALSE
EtniaIndigena                    FALSE      FALSE
EtniaRrom                        FALSE      FALSE
ProgramaComunidad de Cuidado     FALSE      FALSE
1 subsets of each size up to 8
Selection Algorithm: exhaustive
         LRT_A Peso Edad SexoMasculino EtniaBlanco-Mestizo EtniaIndigena
1  ( 1 ) "*"   " "  " "  " "           " "                 " "          
2  ( 1 ) "*"   " "  " "  "*"           " "                 " "          
3  ( 1 ) "*"   " "  "*"  "*"           " "                 " "          
4  ( 1 ) "*"   "*"  "*"  "*"           " "                 " "          
5  ( 1 ) "*"   " "  "*"  "*"           "*"                 "*"          
6  ( 1 ) "*"   " "  "*"  "*"           "*"                 "*"          
7  ( 1 ) "*"   "*"  "*"  "*"           "*"                 "*"          
8  ( 1 ) "*"   "*"  "*"  "*"           "*"                 "*"          
         EtniaRrom ProgramaComunidad de Cuidado
1  ( 1 ) " "       " "                         
2  ( 1 ) " "       " "                         
3  ( 1 ) " "       " "                         
4  ( 1 ) " "       " "                         
5  ( 1 ) " "       " "                         
6  ( 1 ) "*"       " "                         
7  ( 1 ) "*"       " "                         
8  ( 1 ) "*"       "*"                         </code></pre>
</div>
</div>
<p><span class="math inline">\(R^2\)</span>, <span class="math inline">\(R^2\)</span> ajustado, SCE, y BIC para cada mejor modelo del correspondiente tamaño:</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.8698667 0.8801420 0.8867299 0.8869827 0.8873673 0.8877334 0.8879118
[8] 0.8879344</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.8696326 0.8797100 0.8861165 0.8861653 0.8863471 0.8865109 0.8864852
[8] 0.8863014</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 6553.144 6035.711 5703.960 5691.228 5671.863 5653.429 5644.443 5643.306</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -1125.223 -1164.794 -1190.016 -1184.938 -1180.516 -1176.008 -1170.571
[8] -1164.359</code></pre>
</div>
</div>
<p>Usando el criterio BIC, el mejor modelo es el de 3 variables:</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>[1] 3</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="modelos_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="modelos_files/figure-html/unnamed-chunk-5-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Usando el <span class="math inline">\(R^2\)</span> ajustado, se sugiere un modelo con 5 variables:</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="modelos_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Los coeficientes del mejor modelo usando el criterio de BIC son:</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>  (Intercept)         LRT_A          Edad SexoMasculino 
   58.6716838     2.1887673    -0.1154329     3.0592396 </code></pre>
</div>
</div>
<p>Esto sugiere usar el modelo <span class="math inline">\(Talla = 58.67 + 2.19 LRT\_A - 0.12Edad + 3.06Sexo\)</span>,<br>
<span class="math display">\[Sexo = \begin{cases} 1 &amp; \text{si sexo = hombre} \\ 0 &amp; \text{si sexo = mujer} \end{cases}\]</span></p>
<p>Ahora se hará la búsqueda del mejor modelo usando <strong><em>K - fold cross validation</em></strong> con el fin de calcular directamente los errores de predicción sobre los datos de testeo y evitar así el sobreajuste.</p>
<ul>
<li>Se crean <strong><em>K - folds</em></strong> (pliegues) de aproximadamente igual tamaño. En este caso fijamos <span class="math inline">\(k = 10\)</span>. Como tenemos <span class="math inline">\(558\)</span> datos, cada pliegue será de tamaño 55 o 56.</li>
<li>El <span class="math inline">\(k-ésimo\)</span> pliegue servirá para testear, y los demás pliegues se juntan para entrenar los modelos. Osea que se usará un <span class="math inline">\(90\%\)</span> de los datos para entrenamiento y <span class="math inline">\(10\%\)</span> para test.</li>
<li>Para <span class="math inline">\(k = 1,\cdots,10,\)</span> se hace la búsqueda del mejor modelo para cada número de variables y se calcula el MSE.</li>
<li>Luego, se promedia el MSE a través de los <span class="math inline">\(10\)</span> pliegues y se escoge el tamaño de modelo con menor MSE promedio.</li>
<li>Finalmente, se hace la búsqueda del mejor modelo por cada número de variables usando todos los datos disponibles y se escoge el modelo asociado al tamaño del modelo obtenido en la validación cruzada.</li>
</ul>
<p>Tamaño de los pliegues:</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>folds
 1  2  3  4  5  6  7  8  9 10 
56 56 56 56 56 56 56 56 55 55 </code></pre>
</div>
</div>
<p>MSE promedio a través de los <span class="math inline">\(10\)</span> pliegues para cada número de variables incluídas en el modelo:</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>Reordering variables and trying again:</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>       1        2        3        4        5        6        7 
11.82329 10.93287 10.37418 10.64898 10.69236 10.62427 10.60688 </code></pre>
</div>
</div>
<p>El MSE se minimiza usando un modelo de 3 variables:</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="modelos_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Se busca nuevamente el mejor modelo de tres variables usando todos los datos:</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>[1] -1125.223 -1164.794 -1190.016 -1184.938 -1180.516 -1176.008 -1170.571
[8] -1164.359</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  (Intercept)         LRT_A          Edad SexoMasculino 
   58.6716838     2.1887673    -0.1154329     3.0592396 </code></pre>
</div>
</div>
<p>Casualmente volvió a dar el mismo modelo con tres variables que incluye LRT_A, la Edad y el Sexo. Esto es seguramente porque las demás variables no contribuyen significativamente a la presición predictiva de los modelos.</p>
<p>Ahora se validarán los supuestos para el mejor modelo obtenido:</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = Talla ~ LRT_A + Edad + Sexo, data = datos)

Residuals:
     Min       1Q   Median       3Q      Max 
-10.4143  -2.0653   0.0994   2.3139   9.2337 

Coefficients:
              Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)   58.67168    2.87941  20.376  &lt; 2e-16 ***
LRT_A          2.18877    0.05318  41.160  &lt; 2e-16 ***
Edad          -0.11543    0.02034  -5.676 2.22e-08 ***
SexoMasculino  3.05924    0.38579   7.930 1.22e-14 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 3.209 on 554 degrees of freedom
Multiple R-squared:  0.8867,    Adjusted R-squared:  0.8861 
F-statistic:  1446 on 3 and 554 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
<p>El modelo tiene un <span class="math inline">\(R^2\)</span> ajustado de <span class="math inline">\(0.8861\)</span>, es decir que aproximadamente un <span class="math inline">\(88.61\%\)</span> de la variabilidad de la talla es explicada por LRT_A, la edad y el sexo.</p>
<p><strong><em>Linealidad:</em></strong> Con el fin de verificar que la relación entre la talla y las variables LRT_A (discriminando por sexo) y la edad es lineal, se visualiza el gráfico de los residuos vs los valores predichos del modelo <span class="math inline">\(\left(\hat{e},\hat{y} \right)\)</span>:</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="modelos_files/figure-html/unnamed-chunk-13-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>El gráfico no muestra ningún patrón marcado, la ubicación de los puntos parece ser aleatoria alrededor de cero, indicando también homoscedasticidad en los residuales y posible independencia de los mismos. El gráfico muestra algunos valores atípicos que valdría la pena explorar.</p>
<p><strong><em>Independencia de los errores:</em></strong> Aunque nuestros datos no son temporales, el test de Durbin-Watson nos puede ayudar a evaluar la autocorrelación de los errores del modelo:</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>
    Durbin-Watson test

data:  reg
DW = 2.0611, p-value = 0.7602
alternative hypothesis: true autocorrelation is greater than 0</code></pre>
</div>
</div>
<p>La estadística del test de Durbin-Watson es muy cercano a <span class="math inline">\(2\)</span>, se concluye que los errores son independientes.</p>
<p><strong><em>Normalidad de los errores:</em></strong> Se realiza el gráfico QQ-plot para comparar la distribución de los residuales del modelo con la distribución teórica de una normal. También se hace el test de normalidad de Lilliefors y Anderson-Darling:</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="modelos_files/figure-html/unnamed-chunk-15-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Lilliefors (Kolmogorov-Smirnov) normality test

data:  reg$residuals
D = 0.020992, p-value = 0.7968</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Anderson-Darling normality test

data:  reg$residuals
A = 0.32808, p-value = 0.5169</code></pre>
</div>
</div>
<p>El QQ-plot muestra que los residuales se ajustan aceptablemente a una distribución normal. Las pruebas de normalidad de Lilliefors y Anderson-Darling también apoyan este resultado.</p>
<p><strong><em>Homoscedasticidad:</em></strong> Aunque no se vio un patron que indicara heteroscedasticidad en el gráfico de los residuales vs los valores predichos, a continuación se muestra el gráfico de los residuales estandarizados vs los valores predichos con el fin de mejorar la interpretabilidad de la homoscedasticidad y tener una visión más clara de las observaciones atípicas e influyentes:</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="modelos_files/figure-html/unnamed-chunk-16-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>No se observan patrones que indiquen hereroscedasticidad en los residuos (forma de cono o embudo). Se siguien observando algunas observaciones atípicas y/o influyentes.</p>
<p>Adicional, se realiza la prueba de Breusch-Pagan para verificar la homoscedasticidad de los residuales:</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>
    studentized Breusch-Pagan test

data:  reg
BP = 0.55158, df = 3, p-value = 0.9074</code></pre>
</div>
</div>
<p>No se rechaza la hipótesis nula de que los errores del modelo son homoscedasticos.</p>
<p><strong><em>Multicolinealidad:</em></strong> Se verifica que las variables incluídas en el modelo no están altamente correlacionadas entre sí, y así evitar obtener resultados inestables que dificulten la interpretabilidad de los coeficientes del modelo. Se calculan los Factores de Inflación de la Varianza (VIFs):</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>   LRT_A     Edad     Sexo 
1.969323 1.033462 2.016124 </code></pre>
</div>
</div>
<p>Dado que los VIFs son mucho menores a 5, esto indica que cada variable tiene una correlación moderada (leve) con las demás. Por lo que se puede concluir que los resultados del modelo posiblemente no estarán muy afectados por la multicolinealidad.</p>
<p><strong><em>El modelo está bien especificado:</em></strong> Se hace el test de RESET para examinar si el modelo ajustado está bien especificado o si se han omitido términos no lineales o interacciones importantes:</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>
    RESET test

data:  reg
RESET = 0.59636, df1 = 4, df2 = 550, p-value = 0.6654</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
    RESET test

data:  reg
RESET = 0.55668, df1 = 2, df2 = 552, p-value = 0.5734</code></pre>
</div>
</div>
<p>No se rechaza la hipótesis nula de que el modelo está bien especificado.</p>
<p><strong><em>Obervaciones atípicas y de alto apalancamiento:</em></strong></p>
<div>

</div>
<div class="cell quarto-layout-panel" data-layout-ncol="2">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="modelos_files/figure-html/unnamed-chunk-20-1.png" class="img-fluid" width="672"></p>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="modelos_files/figure-html/unnamed-chunk-20-2.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
<p>Usando los residuales estudentizados, se observan <span class="math inline">\(5\)</span> datos atípicos.</p>
<div>

</div>
<div class="cell quarto-layout-panel" data-layout-ncol="2">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="modelos_files/figure-html/unnamed-chunk-21-1.png" class="img-fluid" width="672"></p>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="modelos_files/figure-html/unnamed-chunk-21-2.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="quarto-layout-row">
<div class="cell-output cell-output-stdout quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<pre><code>       StudRes        Hat       CookD
43  -2.9217034 0.01478212 0.031589921
518 -0.6883523 0.02931721 0.003581125
533 -3.2921956 0.01084187 0.029181318
549  2.3779296 0.02294907 0.032927013
552 -0.8119336 0.02399702 0.004054660</code></pre>
</div>
</div>
</div>
<p>En total 29 observaciones superan el umbral especificado para la distancia de Cook, pero esto no significa que todas sean influyentes (alto leverage). Particularmente hay 3 observaciones que son marcadas como influyentes significativamente según la distancia de Cook. Esto indica que la inclusión de estas observaciones en el modelo pueden tener una influencia significativa en los coeficientes del modelo y en la predicción de la talla. Se debe explorar con cautela estas observaciones y decidir qué hacer con ellas.</p>
<p>Para esto, se puede comprobar el cambio en los coeficientes del modelo al excluir estas observaciones influyentes.</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = Talla ~ LRT_A + Edad + Sexo, data = datos, subset = {
    setdiff(row(datos)[, 1], c(533, 43, 549))
})

Residuals:
   Min     1Q Median     3Q    Max 
-8.689 -1.982  0.043  2.264  9.363 

Coefficients:
              Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)   58.77804    2.83614  20.725  &lt; 2e-16 ***
LRT_A          2.19904    0.05272  41.713  &lt; 2e-16 ***
Edad          -0.12388    0.02007  -6.171 1.31e-09 ***
SexoMasculino  3.12662    0.37990   8.230 1.36e-15 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 3.145 on 551 degrees of freedom
Multiple R-squared:  0.8907,    Adjusted R-squared:  0.8901 
F-statistic:  1497 on 3 and 551 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
<p>Las estimaciones de los coeficientes del modelo sin las obervaciones influyentes han cambiado un poco respecto al modelo original. El <span class="math inline">\(R^2\)</span> ajustado ha incrementado un poco también.</p>
</section>
<section id="modelo-normal" class="level2">
<h2 class="anchored" data-anchor-id="modelo-normal">Modelo normal</h2>
<section id="lrt-antropómetro" class="level3">
<h3 class="anchored" data-anchor-id="lrt-antropómetro">LRT Antropómetro</h3>
<p>A continuación se hace una búsqueda del mejor modelo por cada número de posibles combinaciones de variables de las cuales se tenga evidencia que influyen en la talla de adultos mayores. Primero se hará la búsqueda usando todo el conjunto de datos.</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>Subset selection object
Call: regsubsets.formula(Talla ~ LRT_A + Edad + Sexo + Etnia, datos, 
    nbest = 1, nvmax = 10)
6 Variables  (and intercept)
                    Forced in Forced out
LRT_A                   FALSE      FALSE
Edad                    FALSE      FALSE
SexoMasculino           FALSE      FALSE
EtniaBlanco-Mestizo     FALSE      FALSE
EtniaIndigena           FALSE      FALSE
EtniaRrom               FALSE      FALSE
1 subsets of each size up to 6
Selection Algorithm: exhaustive
         LRT_A Edad SexoMasculino EtniaBlanco-Mestizo EtniaIndigena EtniaRrom
1  ( 1 ) "*"   " "  " "           " "                 " "           " "      
2  ( 1 ) "*"   " "  "*"           " "                 " "           " "      
3  ( 1 ) "*"   "*"  "*"           " "                 " "           " "      
4  ( 1 ) "*"   "*"  "*"           " "                 "*"           " "      
5  ( 1 ) "*"   "*"  "*"           "*"                 "*"           " "      
6  ( 1 ) "*"   "*"  "*"           "*"                 "*"           "*"      </code></pre>
</div>
</div>
<p><span class="math inline">\(R^2\)</span>, <span class="math inline">\(R^2\)</span> ajustado, SCE, y BIC para cada mejor modelo del correspondiente tamaño:</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.8698667 0.8801420 0.8867299 0.8868657 0.8873673 0.8877334</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.8696326 0.8797100 0.8861165 0.8860474 0.8863471 0.8865109</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 6553.144 6035.711 5703.960 5697.122 5671.863 5653.429</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -1125.223 -1164.794 -1190.016 -1184.360 -1180.516 -1176.008</code></pre>
</div>
</div>
<p>Usando el criterio BIC, el mejor modelo es el de 3 variables:</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>[1] 3</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="modelos_files/figure-html/unnamed-chunk-25-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="modelos_files/figure-html/unnamed-chunk-25-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Los coeficientes del mejor modelo usando el criterio de BIC son:</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>  (Intercept)         LRT_A          Edad SexoMasculino 
   58.6716838     2.1887673    -0.1154329     3.0592396 </code></pre>
</div>
</div>
<p>Esto sugiere usar el modelo <span class="math inline">\(Talla = 58.67 + 2.19 LRT\_A - 0.12Edad + 3.06Sexo\)</span>,<br>
<span class="math display">\[Sexo = \begin{cases} 1 &amp; \text{si sexo = hombre} \\ 0 &amp; \text{si sexo = mujer} \end{cases}\]</span></p>
<p>Ahora se hará la búsqueda del mejor modelo usando <strong><em>K - fold cross validation</em></strong> con el fin de calcular directamente los errores de predicción sobre los datos de testeo y evitar así el sobreajuste.</p>
<ul>
<li>Se crean <strong><em>K - folds</em></strong> (pliegues) de aproximadamente igual tamaño. En este caso fijamos <span class="math inline">\(k = 10\)</span>. Como tenemos <span class="math inline">\(558\)</span> datos, cada pliegue será de tamaño 55 o 56.</li>
<li>El <span class="math inline">\(k-ésimo\)</span> pliegue servirá para testear, y los demás pliegues se juntan para entrenar los modelos. Osea que se usará un <span class="math inline">\(90\%\)</span> de los datos para entrenamiento y <span class="math inline">\(10\%\)</span> para test.</li>
<li>Para <span class="math inline">\(k = 1,\cdots,10,\)</span> se calcula el MSE.</li>
<li>Luego, se promedia el MSE a través de los <span class="math inline">\(10\)</span> pliegues y se obtiene el MSE promedio.</li>
</ul>
<p>El MSE para el modelo de 3 variables (<span class="math inline">\(LRT\_A, Edad, Sexo\)</span>) es:</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>[1] 10.37418</code></pre>
</div>
</div>
<p>Ahora se validarán los supuestos para el mejor modelo obtenido:</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = Talla ~ LRT_A + Edad + Sexo, data = datos)

Residuals:
     Min       1Q   Median       3Q      Max 
-10.4143  -2.0653   0.0994   2.3139   9.2337 

Coefficients:
              Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)   58.67168    2.87941  20.376  &lt; 2e-16 ***
LRT_A          2.18877    0.05318  41.160  &lt; 2e-16 ***
Edad          -0.11543    0.02034  -5.676 2.22e-08 ***
SexoMasculino  3.05924    0.38579   7.930 1.22e-14 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 3.209 on 554 degrees of freedom
Multiple R-squared:  0.8867,    Adjusted R-squared:  0.8861 
F-statistic:  1446 on 3 and 554 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
<p>El modelo tiene un <span class="math inline">\(R^2\)</span> ajustado de <span class="math inline">\(0.8861\)</span>, es decir que aproximadamente un <span class="math inline">\(88.61\%\)</span> de la variabilidad de la talla es explicada por LRT_A, la edad y el sexo.</p>
<p><strong><em>Linealidad:</em></strong> Con el fin de verificar que la relación entre la talla y las variables LRT_A (discriminando por sexo) y la edad es lineal, se visualiza el gráfico de los residuos vs los valores predichos del modelo <span class="math inline">\(\left(\hat{e},\hat{y} \right)\)</span>:</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="modelos_files/figure-html/unnamed-chunk-30-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>El gráfico no muestra ningún patrón marcado, la ubicación de los puntos parece ser aleatoria alrededor de cero, indicando también homoscedasticidad en los residuales y posible independencia de los mismos. El gráfico muestra algunos valores atípicos que valdría la pena explorar.</p>
<p><strong><em>Independencia de los errores:</em></strong> Aunque nuestros datos no son temporales, el test de Durbin-Watson nos puede ayudar a evaluar la autocorrelación de los errores del modelo:</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>
    Durbin-Watson test

data:  reg
DW = 2.0611, p-value = 0.7602
alternative hypothesis: true autocorrelation is greater than 0</code></pre>
</div>
</div>
<p>La estadística del test de Durbin-Watson es muy cercano a <span class="math inline">\(2\)</span>, se concluye que los errores son independientes.</p>
<p><strong><em>Normalidad de los errores:</em></strong> Se realiza el gráfico QQ-plot para comparar la distribución de los residuales del modelo con la distribución teórica de una normal. También se hace el test de normalidad de Lilliefors y Anderson-Darling:</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="modelos_files/figure-html/unnamed-chunk-32-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Lilliefors (Kolmogorov-Smirnov) normality test

data:  reg$residuals
D = 0.020992, p-value = 0.7968</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Anderson-Darling normality test

data:  reg$residuals
A = 0.32808, p-value = 0.5169</code></pre>
</div>
</div>
<p>El QQ-plot muestra que los residuales se ajustan aceptablemente a una distribución normal. Las pruebas de normalidad de Lilliefors y Anderson-Darling también apoyan este resultado.</p>
<p><strong><em>Homoscedasticidad:</em></strong> Aunque no se vio un patron que indicara heteroscedasticidad en el gráfico de los residuales vs los valores predichos, a continuación se muestra el gráfico de los residuales estandarizados vs los valores predichos con el fin de mejorar la interpretabilidad de la homoscedasticidad y tener una visión más clara de las observaciones atípicas e influyentes:</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="modelos_files/figure-html/unnamed-chunk-33-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>No se observan patrones que indiquen hereroscedasticidad en los residuos (forma de cono o embudo). Se siguien observando algunas observaciones atípicas y/o influyentes.</p>
<p>Adicional, se realiza la prueba de Breusch-Pagan para verificar la homoscedasticidad de los residuales:</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>
    studentized Breusch-Pagan test

data:  reg
BP = 0.55158, df = 3, p-value = 0.9074</code></pre>
</div>
</div>
<p>No se rechaza la hipótesis nula de que los errores del modelo son homoscedasticos.</p>
<p><strong><em>Multicolinealidad:</em></strong> Se verifica que las variables incluídas en el modelo no están altamente correlacionadas entre sí, y así evitar obtener resultados inestables que dificulten la interpretabilidad de los coeficientes del modelo. Se calculan los Factores de Inflación de la Varianza (VIFs):</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>   LRT_A     Edad     Sexo 
1.969323 1.033462 2.016124 </code></pre>
</div>
</div>
<p>Dado que los VIFs son mucho menores a 5, esto indica que cada variable tiene una correlación moderada (leve) con las demás. Por lo que se puede concluir que los resultados del modelo posiblemente no estarán muy afectados por la multicolinealidad.</p>
<p><strong><em>El modelo está bien especificado:</em></strong> Se hace el test de RESET para examinar si el modelo ajustado está bien especificado o si se han omitido términos no lineales o interacciones importantes:</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>
    RESET test

data:  reg
RESET = 0.59636, df1 = 4, df2 = 550, p-value = 0.6654</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
    RESET test

data:  reg
RESET = 0.55668, df1 = 2, df2 = 552, p-value = 0.5734</code></pre>
</div>
</div>
<p>No se rechaza la hipótesis nula de que el modelo está bien especificado.</p>
<p><strong><em>Observaciones atípicas y de alto apalancamiento:</em></strong></p>
<div>

</div>
<div class="cell quarto-layout-panel" data-layout-ncol="2">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="modelos_files/figure-html/unnamed-chunk-37-1.png" class="img-fluid" width="672"></p>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="modelos_files/figure-html/unnamed-chunk-37-2.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
<p>Usando los residuales estudentizados, se observan <span class="math inline">\(5\)</span> datos atípicos.</p>
<div>

</div>
<div class="cell quarto-layout-panel" data-layout-ncol="2">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="modelos_files/figure-html/unnamed-chunk-38-1.png" class="img-fluid" width="672"></p>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="modelos_files/figure-html/unnamed-chunk-38-2.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="quarto-layout-row">
<div class="cell-output cell-output-stdout quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<pre><code>       StudRes        Hat       CookD
43  -2.9217034 0.01478212 0.031589921
518 -0.6883523 0.02931721 0.003581125
533 -3.2921956 0.01084187 0.029181318
549  2.3779296 0.02294907 0.032927013
552 -0.8119336 0.02399702 0.004054660</code></pre>
</div>
</div>
</div>
<p>En total 29 observaciones superan el umbral especificado para la distancia de Cook, pero esto no significa que todas sean influyentes (alto leverage). Particularmente hay 3 observaciones que son marcadas como influyentes significativamente según la distancia de Cook. Esto indica que la inclusión de estas observaciones en el modelo pueden tener una influencia significativa en los coeficientes del modelo y en la predicción de la talla. Se debe explorar con cautela estas observaciones y decidir qué hacer con ellas.</p>
<p>Para esto, se puede comprobar el cambio en los coeficientes del modelo al excluir estas observaciones influyentes.</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = Talla ~ LRT_A + Edad + Sexo, data = datos, subset = {
    setdiff(row(datos)[, 1], c(533, 43, 549))
})

Residuals:
   Min     1Q Median     3Q    Max 
-8.689 -1.982  0.043  2.264  9.363 

Coefficients:
              Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)   58.77804    2.83614  20.725  &lt; 2e-16 ***
LRT_A          2.19904    0.05272  41.713  &lt; 2e-16 ***
Edad          -0.12388    0.02007  -6.171 1.31e-09 ***
SexoMasculino  3.12662    0.37990   8.230 1.36e-15 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 3.145 on 551 degrees of freedom
Multiple R-squared:  0.8907,    Adjusted R-squared:  0.8901 
F-statistic:  1497 on 3 and 551 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
<p>Las estimaciones de los coeficientes del modelo sin las obervaciones influyentes han cambiado un poco respecto al modelo original. El <span class="math inline">\(R^2\)</span> ajustado ha incrementado un poco también.</p>
<section id="solo-para-etnia-blanco-mestizo" class="level4">
<h4 class="anchored" data-anchor-id="solo-para-etnia-blanco-mestizo">Solo para etnia Blanco-Mestizo</h4>
<p>A continuación se hace una búsqueda del mejor modelo por cada número de posibles combinaciones de variables de las cuales se tenga evidencia que influyen en la talla de adultos mayores. Primero se hará la búsqueda usando todo el conjunto de datos.</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>Subset selection object
Call: regsubsets.formula(Talla ~ LRT_A + Edad + Sexo, blmt, nbest = 1, 
    nvmax = 10)
3 Variables  (and intercept)
              Forced in Forced out
LRT_A             FALSE      FALSE
Edad              FALSE      FALSE
SexoMasculino     FALSE      FALSE
1 subsets of each size up to 3
Selection Algorithm: exhaustive
         LRT_A Edad SexoMasculino
1  ( 1 ) "*"   " "  " "          
2  ( 1 ) "*"   " "  "*"          
3  ( 1 ) "*"   "*"  "*"          </code></pre>
</div>
</div>
<p><span class="math inline">\(R^2\)</span>, <span class="math inline">\(R^2\)</span> ajustado, SCE, y BIC para cada mejor modelo del correspondiente tamaño:</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.8701108 0.8801804 0.8869187</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.8698720 0.8797390 0.8862928</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 6366.133 5872.602 5542.343</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -1101.821 -1139.577 -1164.877</code></pre>
</div>
</div>
<p>Usando el criterio BIC, el mejor modelo es el de 3 variables:</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>[1] 3</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="modelos_files/figure-html/unnamed-chunk-42-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="modelos_files/figure-html/unnamed-chunk-42-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Los coeficientes del mejor modelo usando el criterio de BIC son:</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>  (Intercept)         LRT_A          Edad SexoMasculino 
   58.6715908     2.1900483    -0.1159196     3.0285097 </code></pre>
</div>
</div>
<p>Esto sugiere usar el modelo (que es exactamente igual al obtenido teniendo en cuenta todas las etnias) <span class="math inline">\(Talla = 58.67 + 2.19 LRT\_A - 0.12 Edad + 3.06 Sexo\)</span>,<br>
<span class="math display">\[Sexo = \begin{cases} 1 &amp; \text{si sexo = hombre} \\ 0 &amp; \text{si sexo = mujer} \end{cases}\]</span></p>
<p>Ahora se hará la búsqueda del mejor modelo usando <strong><em>K - fold cross validation</em></strong> con el fin de calcular directamente los errores de predicción sobre los datos de testeo y evitar así el sobreajuste.</p>
<ul>
<li>Se crean <strong><em>K - folds</em></strong> (pliegues) de aproximadamente igual tamaño. En este caso fijamos <span class="math inline">\(k = 10\)</span>. Como tenemos <span class="math inline">\(558\)</span> datos, cada pliegue será de tamaño 55 o 56.</li>
<li>El <span class="math inline">\(k-ésimo\)</span> pliegue servirá para testear, y los demás pliegues se juntan para entrenar los modelos. Osea que se usará un <span class="math inline">\(90\%\)</span> de los datos para entrenamiento y <span class="math inline">\(10\%\)</span> para test.</li>
<li>Para <span class="math inline">\(k = 1,\cdots,10,\)</span> se calcula el MSE.</li>
<li>Luego, se promedia el MSE a través de los <span class="math inline">\(10\)</span> pliegues y se obtiene el MSE promedio.</li>
</ul>
<p>El MSE para el modelo de 3 variables (<span class="math inline">\(LRT\_A, Edad, Sexo\)</span>) es:</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>[1] 10.38783</code></pre>
</div>
</div>
<p>Ahora se validarán los supuestos para el mejor modelo obtenido:</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = Talla ~ LRT_A + Edad + Sexo, data = blmt)

Residuals:
     Min       1Q   Median       3Q      Max 
-10.4061  -2.0473   0.0986   2.2993   9.2179 

Coefficients:
              Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)   58.67159    2.89065  20.297  &lt; 2e-16 ***
LRT_A          2.19005    0.05356  40.887  &lt; 2e-16 ***
Edad          -0.11592    0.02040  -5.683 2.16e-08 ***
SexoMasculino  3.02851    0.38843   7.797 3.27e-14 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 3.198 on 542 degrees of freedom
Multiple R-squared:  0.8869,    Adjusted R-squared:  0.8863 
F-statistic:  1417 on 3 and 542 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
<p>El modelo tiene un <span class="math inline">\(R^2\)</span> ajustado de <span class="math inline">\(0.8861\)</span>, es decir que aproximadamente un <span class="math inline">\(88.61\%\)</span> de la variabilidad de la talla es explicada por LRT_A, la edad y el sexo.</p>
<p><strong><em>Linealidad:</em></strong> Con el fin de verificar que la relación entre la talla y las variables LRT_A (discriminando por sexo) y la edad es lineal, se visualiza el gráfico de los residuos vs los valores predichos del modelo <span class="math inline">\(\left(\hat{e},\hat{y} \right)\)</span>:</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="modelos_files/figure-html/unnamed-chunk-47-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>El gráfico no muestra ningún patrón marcado, la ubicación de los puntos parece ser aleatoria alrededor de cero, indicando también homoscedasticidad en los residuales y posible independencia de los mismos. El gráfico muestra algunos valores atípicos que valdría la pena explorar.</p>
<p><strong><em>Independencia de los errores:</em></strong> Aunque nuestros datos no son temporales, el test de Durbin-Watson nos puede ayudar a evaluar la autocorrelación de los errores del modelo:</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>
    Durbin-Watson test

data:  reg
DW = 2.0089, p-value = 0.5342
alternative hypothesis: true autocorrelation is greater than 0</code></pre>
</div>
</div>
<p>La estadística del test de Durbin-Watson es muy cercano a <span class="math inline">\(2\)</span>, se concluye que los errores son independientes.</p>
<p><strong><em>Normalidad de los errores:</em></strong> Se realiza el gráfico QQ-plot para comparar la distribución de los residuales del modelo con la distribución teórica de una normal. También se hace el test de normalidad de Lilliefors y Anderson-Darling:</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="modelos_files/figure-html/unnamed-chunk-49-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Lilliefors (Kolmogorov-Smirnov) normality test

data:  reg$residuals
D = 0.022459, p-value = 0.7233</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Anderson-Darling normality test

data:  reg$residuals
A = 0.37224, p-value = 0.4193</code></pre>
</div>
</div>
<p>El QQ-plot muestra que los residuales se ajustan aceptablemente a una distribución normal. Las pruebas de normalidad de Lilliefors y Anderson-Darling también apoyan este resultado.</p>
<p><strong><em>Homoscedasticidad:</em></strong> Aunque no se vio un patron que indicara heteroscedasticidad en el gráfico de los residuales vs los valores predichos, a continuación se muestra el gráfico de los residuales estandarizados vs los valores predichos con el fin de mejorar la interpretabilidad de la homoscedasticidad y tener una visión más clara de las observaciones atípicas e influyentes:</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="modelos_files/figure-html/unnamed-chunk-50-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>No se observan patrones que indiquen hereroscedasticidad en los residuos (forma de cono o embudo). Se siguien observando algunas observaciones atípicas y/o influyentes.</p>
<p>Adicional, se realiza la prueba de Breusch-Pagan para verificar la homoscedasticidad de los residuales:</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>
    studentized Breusch-Pagan test

data:  reg
BP = 0.64027, df = 3, p-value = 0.8872</code></pre>
</div>
</div>
<p>No se rechaza la hipótesis nula de que los errores del modelo son homoscedasticos.</p>
<p><strong><em>Multicolinealidad:</em></strong> Se verifica que las variables incluídas en el modelo no están altamente correlacionadas entre sí, y así evitar obtener resultados inestables que dificulten la interpretabilidad de los coeficientes del modelo. Se calculan los Factores de Inflación de la Varianza (VIFs):</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>   LRT_A     Edad     Sexo 
1.964084 1.035017 2.012744 </code></pre>
</div>
</div>
<p>Dado que los VIFs son mucho menores a 5, esto indica que cada variable tiene una correlación moderada (leve) con las demás. Por lo que se puede concluir que los resultados del modelo posiblemente no estarán muy afectados por la multicolinealidad.</p>
<p><strong><em>El modelo está bien especificado:</em></strong> Se hace el test de RESET para examinar si el modelo ajustado está bien especificado o si se han omitido términos no lineales o interacciones importantes:</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>
    RESET test

data:  reg
RESET = 0.63552, df1 = 4, df2 = 538, p-value = 0.6373</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
    RESET test

data:  reg
RESET = 0.57179, df1 = 2, df2 = 540, p-value = 0.5649</code></pre>
</div>
</div>
<p>No se rechaza la hipótesis nula de que el modelo está bien especificado.</p>
<p><strong><em>Observaciones atípicas y de alto apalancamiento:</em></strong></p>
<div>

</div>
<div class="cell quarto-layout-panel" data-layout-ncol="2">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="modelos_files/figure-html/unnamed-chunk-54-1.png" class="img-fluid" width="672"></p>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="modelos_files/figure-html/unnamed-chunk-54-2.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
<p>Usando los residuales estudentizados, se observan <span class="math inline">\(5\)</span> datos atípicos.</p>
<div>

</div>
<div class="cell quarto-layout-panel" data-layout-ncol="2">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="modelos_files/figure-html/unnamed-chunk-55-1.png" class="img-fluid" width="672"></p>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="modelos_files/figure-html/unnamed-chunk-55-2.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="quarto-layout-row">
<div class="cell-output cell-output-stdout quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<pre><code>       StudRes        Hat       CookD
43  -2.9359701 0.01530685 0.033034282
518 -0.6931209 0.02977243 0.003689056
533 -3.3020436 0.01104369 0.029893640
549  2.3843805 0.02334252 0.033678946
552 -0.8197563 0.02432382 0.004190815</code></pre>
</div>
</div>
</div>
<p>En total 29 observaciones superan el umbral especificado para la distancia de Cook, pero esto no significa que todas sean influyentes (alto leverage). Particularmente hay 3 observaciones que son marcadas como influyentes significativamente según la distancia de Cook. Esto indica que la inclusión de estas observaciones en el modelo pueden tener una influencia significativa en los coeficientes del modelo y en la predicción de la talla. Se debe explorar con cautela estas observaciones y decidir qué hacer con ellas.</p>
<p>Para esto, se puede comprobar el cambio en los coeficientes del modelo al excluir estas observaciones influyentes.</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = Talla ~ LRT_A + Edad + Sexo, data = blmt, subset = {
    setdiff(row(datos)[, 1], c(533, 43, 549))
})

Residuals:
     Min       1Q   Median       3Q      Max 
-10.3424  -1.9641   0.0838   2.3050   8.4802 

Coefficients:
              Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)   58.10823    2.85589  20.347  &lt; 2e-16 ***
LRT_A          2.21085    0.05310  41.634  &lt; 2e-16 ***
Edad          -0.12168    0.02016  -6.035 2.95e-09 ***
SexoMasculino  3.00695    0.38324   7.846 2.31e-14 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 3.153 on 540 degrees of freedom
  (11 observations deleted due to missingness)
Multiple R-squared:  0.8901,    Adjusted R-squared:  0.8895 
F-statistic:  1458 on 3 and 540 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
<p>Las estimaciones de los coeficientes del modelo sin las obervaciones influyentes han cambiado un poco respecto al modelo original. El <span class="math inline">\(R^2\)</span> ajustado ha incrementado un poco también.</p>
</section>
</section>
<section id="lrt-cinta-métrica" class="level3">
<h3 class="anchored" data-anchor-id="lrt-cinta-métrica">LRT cinta métrica</h3>
<p>A continuación se hace una búsqueda del mejor modelo por cada número de posibles combinaciones de variables de las cuales se tenga evidencia que influyen en la talla de adultos mayores, como medida, se usa la medición de la longitud rodilla-talón con cinta métrica. Primero se hará la búsqueda usando todo el conjunto de datos.</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>Subset selection object
Call: regsubsets.formula(Talla ~ LRT_CM + Edad + Sexo + Etnia, datos, 
    nbest = 1, nvmax = 10)
6 Variables  (and intercept)
                    Forced in Forced out
LRT_CM                  FALSE      FALSE
Edad                    FALSE      FALSE
SexoMasculino           FALSE      FALSE
EtniaBlanco-Mestizo     FALSE      FALSE
EtniaIndigena           FALSE      FALSE
EtniaRrom               FALSE      FALSE
1 subsets of each size up to 6
Selection Algorithm: exhaustive
         LRT_CM Edad SexoMasculino EtniaBlanco-Mestizo EtniaIndigena EtniaRrom
1  ( 1 ) "*"    " "  " "           " "                 " "           " "      
2  ( 1 ) "*"    " "  "*"           " "                 " "           " "      
3  ( 1 ) "*"    "*"  "*"           " "                 " "           " "      
4  ( 1 ) "*"    "*"  "*"           " "                 "*"           " "      
5  ( 1 ) "*"    "*"  "*"           "*"                 "*"           " "      
6  ( 1 ) "*"    "*"  "*"           "*"                 "*"           "*"      </code></pre>
</div>
</div>
<p><span class="math inline">\(R^2\)</span>, <span class="math inline">\(R^2\)</span> ajustado, SCE, y BIC para cada mejor modelo del correspondiente tamaño:</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.8380145 0.8609620 0.8693315 0.8694316 0.8699906 0.8700490</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.8377231 0.8604610 0.8686239 0.8684872 0.8688130 0.8686339</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 8157.132 7001.557 6580.096 6575.054 6546.905 6543.963</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -1003.050 -1081.966 -1110.284 -1104.387 -1100.457 -1094.383</code></pre>
</div>
</div>
<p>Usando el criterio BIC, el mejor modelo es el de 3 variables:</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>[1] 3</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="modelos_files/figure-html/unnamed-chunk-59-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="modelos_files/figure-html/unnamed-chunk-59-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Los coeficientes del mejor modelo usando el criterio de BIC son:</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>  (Intercept)        LRT_CM          Edad SexoMasculino 
   57.2481566     2.1620113    -0.1299881     4.2477737 </code></pre>
</div>
</div>
<p>Esto sugiere usar el modelo <span class="math inline">\(Talla = 57.24 + 2.16 LRT\_A - 0.13 Edad + 4.25 Sexo\)</span>,<br>
<span class="math display">\[Sexo = \begin{cases} 1 &amp; \text{si sexo = hombre} \\ 0 &amp; \text{si sexo = mujer} \end{cases}\]</span></p>
<p>Ahora se hará la búsqueda del mejor modelo usando <strong><em>K - fold cross validation</em></strong> con el fin de calcular directamente los errores de predicción sobre los datos de testeo y evitar así el sobreajuste.</p>
<ul>
<li>Se crean <strong><em>K - folds</em></strong> (pliegues) de aproximadamente igual tamaño. En este caso fijamos <span class="math inline">\(k = 10\)</span>. Como tenemos <span class="math inline">\(558\)</span> datos, cada pliegue será de tamaño 55 o 56.</li>
<li>El <span class="math inline">\(k-ésimo\)</span> pliegue servirá para testear, y los demás pliegues se juntan para entrenar los modelos. Osea que se usará un <span class="math inline">\(90\%\)</span> de los datos para entrenamiento y <span class="math inline">\(10\%\)</span> para test.</li>
<li>Para <span class="math inline">\(k = 1,\cdots,10,\)</span> se calcula el MSE.</li>
<li>Luego, se promedia el MSE a través de los <span class="math inline">\(10\)</span> pliegues y se obtiene el MSE promedio.</li>
</ul>
<p>El MSE para el modelo de 3 variables (<span class="math inline">\(LRT\_A, Edad, Sexo\)</span>) es:</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>[1] 11.95892</code></pre>
</div>
</div>
<p>Ahora se validarán los supuestos para el mejor modelo obtenido:</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = Talla ~ LRT_CM + Edad + Sexo, data = datos)

Residuals:
     Min       1Q   Median       3Q      Max 
-10.1768  -2.1772   0.0313   2.2208  10.5135 

Coefficients:
              Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)   57.24816    3.18643  17.966  &lt; 2e-16 ***
LRT_CM         2.16201    0.05789  37.347  &lt; 2e-16 ***
Edad          -0.12999    0.02182  -5.957 4.57e-09 ***
SexoMasculino  4.24777    0.39777  10.679  &lt; 2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 3.446 on 554 degrees of freedom
Multiple R-squared:  0.8693,    Adjusted R-squared:  0.8686 
F-statistic:  1229 on 3 and 554 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
<p>El modelo tiene un <span class="math inline">\(R^2\)</span> ajustado de <span class="math inline">\(0.8686\)</span>, es decir que aproximadamente un <span class="math inline">\(86.86\%\)</span> de la variabilidad de la talla es explicada por LRT_CM, la edad y el sexo.</p>
<p><strong><em>Linealidad:</em></strong> Con el fin de verificar que la relación entre la talla y las variables LRT_CM (discriminando por sexo) y la edad es lineal, se visualiza el gráfico de los residuos vs los valores predichos del modelo <span class="math inline">\(\left(\hat{e},\hat{y} \right)\)</span>:</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="modelos_files/figure-html/unnamed-chunk-64-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>El gráfico no muestra ningún patrón marcado, la ubicación de los puntos parece ser aleatoria alrededor de cero, indicando también homoscedasticidad en los residuales y posible independencia de los mismos. El gráfico muestra algunos valores atípicos que valdría la pena explorar.</p>
<p><strong><em>Independencia de los errores:</em></strong> Aunque nuestros datos no son temporales, el test de Durbin-Watson nos puede ayudar a evaluar la autocorrelación de los errores del modelo:</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>
    Durbin-Watson test

data:  reg
DW = 2.083, p-value = 0.8329
alternative hypothesis: true autocorrelation is greater than 0</code></pre>
</div>
</div>
<p>La estadística del test de Durbin-Watson es muy cercano a <span class="math inline">\(2\)</span>, se concluye que los errores son independientes.</p>
<p><strong><em>Normalidad de los errores:</em></strong> Se realiza el gráfico QQ-plot para comparar la distribución de los residuales del modelo con la distribución teórica de una normal. También se hace el test de normalidad de Lilliefors y Anderson-Darling:</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="modelos_files/figure-html/unnamed-chunk-66-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Lilliefors (Kolmogorov-Smirnov) normality test

data:  reg$residuals
D = 0.021411, p-value = 0.7732</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Anderson-Darling normality test

data:  reg$residuals
A = 0.3255, p-value = 0.5213</code></pre>
</div>
</div>
<p>El QQ-plot muestra que los residuales se ajustan aceptablemente a una distribución normal. Las pruebas de normalidad de Lilliefors y Anderson-Darling también apoyan este resultado.</p>
<p><strong><em>Homoscedasticidad:</em></strong> Aunque no se vio un patron que indicara heteroscedasticidad en el gráfico de los residuales vs los valores predichos, a continuación se muestra el gráfico de los residuales estandarizados vs los valores predichos con el fin de mejorar la interpretabilidad de la homoscedasticidad y tener una visión más clara de las observaciones atípicas e influyentes:</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="modelos_files/figure-html/unnamed-chunk-67-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>No se observan patrones que indiquen hereroscedasticidad en los residuos (forma de cono o embudo). Se siguien observando algunas observaciones atípicas y/o influyentes.</p>
<p>Adicional, se realiza la prueba de Breusch-Pagan para verificar la homoscedasticidad de los residuales:</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>
    studentized Breusch-Pagan test

data:  reg
BP = 4.3392, df = 3, p-value = 0.2271</code></pre>
</div>
</div>
<p>No se rechaza la hipótesis nula de que los errores del modelo son homoscedasticos.</p>
<p><strong><em>Multicolinealidad:</em></strong> Se verifica que las variables incluídas en el modelo no están altamente correlacionadas entre sí, y así evitar obtener resultados inestables que dificulten la interpretabilidad de los coeficientes del modelo. Se calculan los Factores de Inflación de la Varianza (VIFs):</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>  LRT_CM     Edad     Sexo 
1.816051 1.031567 1.857875 </code></pre>
</div>
</div>
<p>Dado que los VIFs son mucho menores a 5, esto indica que cada variable tiene una correlación moderada (leve) con las demás. Por lo que se puede concluir que los resultados del modelo posiblemente no estarán muy afectados por la multicolinealidad.</p>
<p><strong><em>El modelo está bien especificado:</em></strong> Se hace el test de RESET para examinar si el modelo ajustado está bien especificado o si se han omitido términos no lineales o interacciones importantes:</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>
    RESET test

data:  reg
RESET = 0.72797, df1 = 4, df2 = 550, p-value = 0.5731</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
    RESET test

data:  reg
RESET = 0.26394, df1 = 2, df2 = 552, p-value = 0.7681</code></pre>
</div>
</div>
<p>No se rechaza la hipótesis nula de que el modelo está bien especificado.</p>
<p><strong><em>Observaciones atípicas y de alto apalancamiento:</em></strong></p>
<div>

</div>
<div class="cell quarto-layout-panel" data-layout-ncol="2">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="modelos_files/figure-html/unnamed-chunk-71-1.png" class="img-fluid" width="672"></p>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="modelos_files/figure-html/unnamed-chunk-71-2.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
<p>Usando los residuales estudentizados, se observan <span class="math inline">\(5\)</span> datos atípicos.</p>
<div>

</div>
<div class="cell quarto-layout-panel" data-layout-ncol="2">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="modelos_files/figure-html/unnamed-chunk-72-1.png" class="img-fluid" width="672"></p>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="modelos_files/figure-html/unnamed-chunk-72-2.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="quarto-layout-row">
<div class="cell-output cell-output-stdout quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<pre><code>       StudRes         Hat       CookD
43  -2.9806385 0.016649964 0.037078890
284  2.9957912 0.003681190 0.008172332
374  3.0807810 0.004470673 0.010494809
518 -0.6637692 0.029371716 0.003336486
533 -2.7413682 0.012751983 0.023985495
552 -0.5013029 0.026976469 0.001744173</code></pre>
</div>
</div>
</div>
<p>En total 29 observaciones superan el umbral especificado para la distancia de Cook, pero esto no significa que todas sean influyentes (alto leverage). Particularmente hay 3 observaciones que son marcadas como influyentes significativamente según la distancia de Cook. Esto indica que la inclusión de estas observaciones en el modelo pueden tener una influencia significativa en los coeficientes del modelo y en la predicción de la talla. Se debe explorar con cautela estas observaciones y decidir qué hacer con ellas.</p>
<p>Para esto, se puede comprobar el cambio en los coeficientes del modelo al excluir estas observaciones influyentes.</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = Talla ~ LRT_CM + Edad + Sexo, data = datos, subset = {
    setdiff(row(datos)[, 1], c(533, 43, 504))
})

Residuals:
     Min       1Q   Median       3Q      Max 
-10.2522  -2.2200   0.0548   2.2229  10.5288 

Coefficients:
              Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)   57.91812    3.15350   18.37  &lt; 2e-16 ***
LRT_CM         2.15106    0.05761   37.34  &lt; 2e-16 ***
Edad          -0.13222    0.02143   -6.17 1.33e-09 ***
SexoMasculino  4.40853    0.39386   11.19  &lt; 2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 3.382 on 551 degrees of freedom
Multiple R-squared:  0.8735,    Adjusted R-squared:  0.8728 
F-statistic:  1269 on 3 and 551 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
<p>Las estimaciones de los coeficientes del modelo sin las obervaciones influyentes han cambiado un poco respecto al modelo original. El <span class="math inline">\(R^2\)</span> ajustado ha incrementado un poco también.</p>
</section>
<section id="lrm-pierna-estirada" class="level3">
<h3 class="anchored" data-anchor-id="lrm-pierna-estirada">LRM pierna estirada</h3>
<p>A continuación se hace una búsqueda del mejor modelo por cada número de posibles combinaciones de variables de las cuales se tenga evidencia que influyen en la talla de adultos mayores, solo se tiene en cuenta la medición de la longitud rodilla-maléolo con la pierna estirada. Primero se hará la búsqueda usando todo el conjunto de datos.</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>Subset selection object
Call: regsubsets.formula(Talla ~ LRM_R + Edad + Sexo + Etnia, datos, 
    nbest = 1, nvmax = 10)
6 Variables  (and intercept)
                    Forced in Forced out
LRM_R                   FALSE      FALSE
Edad                    FALSE      FALSE
SexoMasculino           FALSE      FALSE
EtniaBlanco-Mestizo     FALSE      FALSE
EtniaIndigena           FALSE      FALSE
EtniaRrom               FALSE      FALSE
1 subsets of each size up to 6
Selection Algorithm: exhaustive
         LRM_R Edad SexoMasculino EtniaBlanco-Mestizo EtniaIndigena EtniaRrom
1  ( 1 ) "*"   " "  " "           " "                 " "           " "      
2  ( 1 ) "*"   " "  "*"           " "                 " "           " "      
3  ( 1 ) "*"   "*"  "*"           " "                 " "           " "      
4  ( 1 ) "*"   "*"  "*"           " "                 " "           "*"      
5  ( 1 ) "*"   "*"  "*"           "*"                 "*"           " "      
6  ( 1 ) "*"   "*"  "*"           "*"                 "*"           "*"      </code></pre>
</div>
</div>
<p><span class="math inline">\(R^2\)</span>, <span class="math inline">\(R^2\)</span> ajustado, SCE, y BIC para cada mejor modelo del correspondiente tamaño:</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.8337629 0.8515724 0.8588308 0.8590271 0.8594850 0.8601303</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.8334639 0.8510376 0.8580664 0.8580074 0.8582122 0.8586072</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 8371.228 7474.391 7108.879 7098.996 7075.937 7043.440</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1]  -988.5931 -1045.5002 -1067.1529 -1061.6048 -1057.0959 -1053.3401</code></pre>
</div>
</div>
<p>Usando el criterio BIC, el mejor modelo es el de 3 variables:</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>[1] 3</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="modelos_files/figure-html/unnamed-chunk-76-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="modelos_files/figure-html/unnamed-chunk-76-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Los coeficientes del mejor modelo usando el criterio de BIC son:</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>  (Intercept)         LRM_R          Edad SexoMasculino 
   68.8247189     2.2078940    -0.1211314     3.8654525 </code></pre>
</div>
</div>
<p>Esto sugiere usar el modelo <span class="math inline">\(Talla = 68.82 + 2.21 LRM_R - 0.12 Edad + 3.86 Sexo\)</span>,<br>
<span class="math display">\[Sexo = \begin{cases} 1 &amp; \text{si sexo = hombre} \\ 0 &amp; \text{si sexo = mujer} \end{cases}\]</span></p>
<p>Ahora se hará la búsqueda del mejor modelo usando <strong><em>K - fold cross validation</em></strong> con el fin de calcular directamente los errores de predicción sobre los datos de testeo y evitar así el sobreajuste.</p>
<ul>
<li>Se crean <strong><em>K - folds</em></strong> (pliegues) de aproximadamente igual tamaño. En este caso fijamos <span class="math inline">\(k = 10\)</span>. Como tenemos <span class="math inline">\(558\)</span> datos, cada pliegue será de tamaño 55 o 56.</li>
<li>El <span class="math inline">\(k-ésimo\)</span> pliegue servirá para testear, y los demás pliegues se juntan para entrenar los modelos. Osea que se usará un <span class="math inline">\(90\%\)</span> de los datos para entrenamiento y <span class="math inline">\(10\%\)</span> para test.</li>
<li>Para <span class="math inline">\(k = 1,\cdots,10,\)</span> se calcula el MSE.</li>
<li>Luego, se promedia el MSE a través de los <span class="math inline">\(10\)</span> pliegues y se obtiene el MSE promedio.</li>
</ul>
<p>El MSE para el modelo de 3 variables (<span class="math inline">\(LRT\_A, Edad, Sexo\)</span>) es:</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>[1] 10.37418</code></pre>
</div>
</div>
<p>Ahora se validarán los supuestos para el mejor modelo obtenido:</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = Talla ~ LRM_R + Edad + Sexo, data = datos)

Residuals:
     Min       1Q   Median       3Q      Max 
-13.2132  -2.2352   0.0492   2.3139  10.1632 

Coefficients:
              Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)   68.82472    3.07042  22.415  &lt; 2e-16 ***
LRM_R          2.20789    0.06245  35.353  &lt; 2e-16 ***
Edad          -0.12113    0.02270  -5.337 1.38e-07 ***
SexoMasculino  3.86545    0.42383   9.120  &lt; 2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 3.582 on 554 degrees of freedom
Multiple R-squared:  0.8588,    Adjusted R-squared:  0.8581 
F-statistic:  1123 on 3 and 554 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
<p>El modelo tiene un <span class="math inline">\(R^2\)</span> ajustado de <span class="math inline">\(0.8861\)</span>, es decir que aproximadamente un <span class="math inline">\(88.61\%\)</span> de la variabilidad de la talla es explicada por LRM_R, la edad y el sexo.</p>
<p><strong><em>Linealidad:</em></strong> Con el fin de verificar que la relación entre la talla y las variables LRM_R (discriminando por sexo) y la edad es lineal, se visualiza el gráfico de los residuos vs los valores predichos del modelo <span class="math inline">\(\left(\hat{e},\hat{y} \right)\)</span>:</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="modelos_files/figure-html/unnamed-chunk-81-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>El gráfico no muestra ningún patrón marcado, la ubicación de los puntos parece ser aleatoria alrededor de cero, indicando también homoscedasticidad en los residuales y posible independencia de los mismos. El gráfico muestra algunos valores atípicos que valdría la pena explorar.</p>
<p><strong><em>Independencia de los errores:</em></strong> Aunque nuestros datos no son temporales, el test de Durbin-Watson nos puede ayudar a evaluar la autocorrelación de los errores del modelo:</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>
    Durbin-Watson test

data:  reg
DW = 1.9078, p-value = 0.1345
alternative hypothesis: true autocorrelation is greater than 0</code></pre>
</div>
</div>
<p>La estadística del test de Durbin-Watson es muy cercano a <span class="math inline">\(2\)</span>, se concluye que los errores son independientes.</p>
<p><strong><em>Normalidad de los errores:</em></strong> Se realiza el gráfico QQ-plot para comparar la distribución de los residuales del modelo con la distribución teórica de una normal. También se hace el test de normalidad de Lilliefors y Anderson-Darling:</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="modelos_files/figure-html/unnamed-chunk-83-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Lilliefors (Kolmogorov-Smirnov) normality test

data:  reg$residuals
D = 0.020548, p-value = 0.8212</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Anderson-Darling normality test

data:  reg$residuals
A = 0.27849, p-value = 0.6483</code></pre>
</div>
</div>
<p>El QQ-plot muestra que los residuales se ajustan aceptablemente a una distribución normal. Las pruebas de normalidad de Lilliefors y Anderson-Darling también apoyan este resultado.</p>
<p><strong><em>Homoscedasticidad:</em></strong> Aunque no se vio un patron que indicara heteroscedasticidad en el gráfico de los residuales vs los valores predichos, a continuación se muestra el gráfico de los residuales estandarizados vs los valores predichos con el fin de mejorar la interpretabilidad de la homoscedasticidad y tener una visión más clara de las observaciones atípicas e influyentes:</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="modelos_files/figure-html/unnamed-chunk-84-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>No se observan patrones que indiquen hereroscedasticidad en los residuos (forma de cono o embudo). Se siguien observando algunas observaciones atípicas y/o influyentes.</p>
<p>Adicional, se realiza la prueba de Breusch-Pagan para verificar la homoscedasticidad de los residuales:</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>
    studentized Breusch-Pagan test

data:  reg
BP = 7.8596, df = 3, p-value = 0.04901</code></pre>
</div>
</div>
<p>Se rechaza la hipótesis nula de que los errores del modelo son homoscedasticos.</p>
<p><strong><em>Multicolinealidad:</em></strong> Se verifica que las variables incluídas en el modelo no están altamente correlacionadas entre sí, y así evitar obtener resultados inestables que dificulten la interpretabilidad de los coeficientes del modelo. Se calculan los Factores de Inflación de la Varianza (VIFs):</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>   LRM_R     Edad     Sexo 
1.907229 1.032902 1.952447 </code></pre>
</div>
</div>
<p>Dado que los VIFs son mucho menores a 5, esto indica que cada variable tiene una correlación moderada (leve) con las demás. Por lo que se puede concluir que los resultados del modelo posiblemente no estarán muy afectados por la multicolinealidad.</p>
<p><strong><em>El modelo está bien especificado:</em></strong> Se hace el test de RESET para examinar si el modelo ajustado está bien especificado o si se han omitido términos no lineales o interacciones importantes:</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>
    RESET test

data:  reg
RESET = 0.67777, df1 = 4, df2 = 550, p-value = 0.6076</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
    RESET test

data:  reg
RESET = 0.012072, df1 = 2, df2 = 552, p-value = 0.988</code></pre>
</div>
</div>
<p>No se rechaza la hipótesis nula de que el modelo está bien especificado.</p>
<p><strong><em>Observaciones atípicas y de alto apalancamiento:</em></strong></p>
<div>

</div>
<div class="cell quarto-layout-panel" data-layout-ncol="2">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="modelos_files/figure-html/unnamed-chunk-88-1.png" class="img-fluid" width="672"></p>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="modelos_files/figure-html/unnamed-chunk-88-2.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
<p>Usando los residuales estudentizados, se observan <span class="math inline">\(5\)</span> datos atípicos.</p>
<div>

</div>
<div class="cell quarto-layout-panel" data-layout-ncol="2">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="modelos_files/figure-html/unnamed-chunk-89-1.png" class="img-fluid" width="672"></p>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="modelos_files/figure-html/unnamed-chunk-89-2.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="quarto-layout-row">
<div class="cell-output cell-output-stdout quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<pre><code>       StudRes         Hat        CookD
518  0.2187011 0.032266703 0.0003993814
533 -3.7468704 0.008055180 0.0278459402
542 -3.4439564 0.008737432 0.0256341372
552 -0.3225551 0.029079267 0.0007802801</code></pre>
</div>
</div>
</div>
<p>En total 29 observaciones superan el umbral especificado para la distancia de Cook, pero esto no significa que todas sean influyentes (alto leverage). Particularmente hay 3 observaciones que son marcadas como influyentes significativamente según la distancia de Cook. Esto indica que la inclusión de estas observaciones en el modelo pueden tener una influencia significativa en los coeficientes del modelo y en la predicción de la talla. Se debe explorar con cautela estas observaciones y decidir qué hacer con ellas.</p>
<p>Para esto, se puede comprobar el cambio en los coeficientes del modelo al excluir estas observaciones influyentes.</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = Talla ~ LRM_R + Edad + Sexo, data = datos, subset = {
    setdiff(row(datos)[, 1], c(533, 542, 504))
})

Residuals:
    Min      1Q  Median      3Q     Max 
-9.4982 -2.3136 -0.0108  2.2634 10.2233 

Coefficients:
              Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)   69.74806    2.99218  23.310  &lt; 2e-16 ***
LRM_R          2.17604    0.06096  35.698  &lt; 2e-16 ***
Edad          -0.11543    0.02210  -5.224 2.48e-07 ***
SexoMasculino  4.04460    0.41435   9.761  &lt; 2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 3.478 on 551 degrees of freedom
Multiple R-squared:  0.8653,    Adjusted R-squared:  0.8645 
F-statistic:  1180 on 3 and 551 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
<p>Las estimaciones de los coeficientes del modelo sin las obervaciones influyentes han cambiado un poco respecto al modelo original. El <span class="math inline">\(R^2\)</span> ajustado ha incrementado un poco también.</p>
</section>
<section id="lrm-pierna-a-90" class="level3">
<h3 class="anchored" data-anchor-id="lrm-pierna-a-90">LRM pierna a 90°</h3>
<p>A continuación se hace una búsqueda del mejor modelo por cada número de posibles combinaciones de variables de las cuales se tenga evidencia que influyen en la talla de adultos mayores, únicamente se tiene en cuenta la longitud rodilla-malélo con la pierna a 90°. Primero se hará la búsqueda usando todo el conjunto de datos.</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>Subset selection object
Call: regsubsets.formula(Talla ~ LRM_90 + Edad + Sexo + Etnia, datos, 
    nbest = 1, nvmax = 10)
6 Variables  (and intercept)
                    Forced in Forced out
LRM_90                  FALSE      FALSE
Edad                    FALSE      FALSE
SexoMasculino           FALSE      FALSE
EtniaBlanco-Mestizo     FALSE      FALSE
EtniaIndigena           FALSE      FALSE
EtniaRrom               FALSE      FALSE
1 subsets of each size up to 6
Selection Algorithm: exhaustive
         LRM_90 Edad SexoMasculino EtniaBlanco-Mestizo EtniaIndigena EtniaRrom
1  ( 1 ) "*"    " "  " "           " "                 " "           " "      
2  ( 1 ) "*"    " "  "*"           " "                 " "           " "      
3  ( 1 ) "*"    "*"  "*"           " "                 " "           " "      
4  ( 1 ) "*"    "*"  "*"           " "                 " "           "*"      
5  ( 1 ) "*"    "*"  "*"           "*"                 " "           "*"      
6  ( 1 ) "*"    "*"  "*"           "*"                 "*"           "*"      </code></pre>
</div>
</div>
<p><span class="math inline">\(R^2\)</span>, <span class="math inline">\(R^2\)</span> ajustado, SCE, y BIC para cada mejor modelo del correspondiente tamaño:</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.7961311 0.8337231 0.8397734 0.8398928 0.8400479 0.8403034</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.7957644 0.8331239 0.8389057 0.8387347 0.8385991 0.8385644</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 10266.259  8373.231  8068.558  8062.544  8054.733  8041.869</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -874.7265 -982.1352 -996.4932 -990.5849 -984.8014 -979.3690</code></pre>
</div>
</div>
<p>Usando el criterio BIC, el mejor modelo es el de 3 variables:</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>[1] 3</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="modelos_files/figure-html/unnamed-chunk-93-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="modelos_files/figure-html/unnamed-chunk-93-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Los coeficientes del mejor modelo usando el criterio de BIC son:</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>  (Intercept)        LRM_90          Edad SexoMasculino 
   69.3329277     2.1236746    -0.1107071     5.1812086 </code></pre>
</div>
</div>
<p>Esto sugiere usar el modelo <span class="math inline">\(Talla = 69.33 + 2.12 LRM\_90 - 0.11 Edad + 5.18 Sexo\)</span>,<br>
<span class="math display">\[Sexo = \begin{cases} 1 &amp; \text{si sexo = hombre} \\ 0 &amp; \text{si sexo = mujer} \end{cases}\]</span></p>
<p>Ahora se hará la búsqueda del mejor modelo usando <strong><em>K - fold cross validation</em></strong> con el fin de calcular directamente los errores de predicción sobre los datos de testeo y evitar así el sobreajuste.</p>
<ul>
<li>Se crean <strong><em>K - folds</em></strong> (pliegues) de aproximadamente igual tamaño. En este caso fijamos <span class="math inline">\(k = 10\)</span>. Como tenemos <span class="math inline">\(558\)</span> datos, cada pliegue será de tamaño 55 o 56.</li>
<li>El <span class="math inline">\(k-ésimo\)</span> pliegue servirá para testear, y los demás pliegues se juntan para entrenar los modelos. Osea que se usará un <span class="math inline">\(90\%\)</span> de los datos para entrenamiento y <span class="math inline">\(10\%\)</span> para test.</li>
<li>Para <span class="math inline">\(k = 1,\cdots,10,\)</span> se calcula el MSE.</li>
<li>Luego, se promedia el MSE a través de los <span class="math inline">\(10\)</span> pliegues y se obtiene el MSE promedio.</li>
</ul>
<p>El MSE para el modelo de 3 variables (<span class="math inline">\(LRT\_A, Edad, Sexo\)</span>) es:</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>[1] 10.37418</code></pre>
</div>
</div>
<p>Ahora se validarán los supuestos para el mejor modelo obtenido:</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = Talla ~ LRM_90 + Edad + Sexo, data = datos)

Residuals:
     Min       1Q   Median       3Q      Max 
-21.5663  -2.2713   0.1688   2.3794   9.0779 

Coefficients:
              Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)    69.3329     3.3320  20.808  &lt; 2e-16 ***
LRM_90          2.1237     0.0660  32.176  &lt; 2e-16 ***
Edad           -0.1107     0.0242  -4.574 5.91e-06 ***
SexoMasculino   5.1812     0.4307  12.030  &lt; 2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 3.816 on 554 degrees of freedom
Multiple R-squared:  0.8398,    Adjusted R-squared:  0.8389 
F-statistic: 967.9 on 3 and 554 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
<p>El modelo tiene un <span class="math inline">\(R^2\)</span> ajustado de <span class="math inline">\(0.8861\)</span>, es decir que aproximadamente un <span class="math inline">\(88.61\%\)</span> de la variabilidad de la talla es explicada por LRT_A, la edad y el sexo.</p>
<p><strong><em>Linealidad:</em></strong> Con el fin de verificar que la relación entre la talla y las variables LRT_A (discriminando por sexo) y la edad es lineal, se visualiza el gráfico de los residuos vs los valores predichos del modelo <span class="math inline">\(\left(\hat{e},\hat{y} \right)\)</span>:</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="modelos_files/figure-html/unnamed-chunk-98-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>El gráfico no muestra ningún patrón marcado, la ubicación de los puntos parece ser aleatoria alrededor de cero, indicando también homoscedasticidad en los residuales y posible independencia de los mismos. El gráfico muestra algunos valores atípicos que valdría la pena explorar.</p>
<p><strong><em>Independencia de los errores:</em></strong> Aunque nuestros datos no son temporales, el test de Durbin-Watson nos puede ayudar a evaluar la autocorrelación de los errores del modelo:</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>
    Durbin-Watson test

data:  reg
DW = 2.0319, p-value = 0.6411
alternative hypothesis: true autocorrelation is greater than 0</code></pre>
</div>
</div>
<p>La estadística del test de Durbin-Watson es muy cercano a <span class="math inline">\(2\)</span>, se concluye que los errores son independientes.</p>
<p><strong><em>Normalidad de los errores:</em></strong> Se realiza el gráfico QQ-plot para comparar la distribución de los residuales del modelo con la distribución teórica de una normal. También se hace el test de normalidad de Lilliefors y Anderson-Darling:</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="modelos_files/figure-html/unnamed-chunk-100-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Lilliefors (Kolmogorov-Smirnov) normality test

data:  reg$residuals
D = 0.037043, p-value = 0.06538</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Anderson-Darling normality test

data:  reg$residuals
A = 0.6184, p-value = 0.1071</code></pre>
</div>
</div>
<p>El QQ-plot muestra que los residuales se ajustan aceptablemente a una distribución normal. Las pruebas de normalidad de Lilliefors y Anderson-Darling también apoyan este resultado.</p>
<p><strong><em>Homoscedasticidad:</em></strong> Aunque no se vio un patron que indicara heteroscedasticidad en el gráfico de los residuales vs los valores predichos, a continuación se muestra el gráfico de los residuales estandarizados vs los valores predichos con el fin de mejorar la interpretabilidad de la homoscedasticidad y tener una visión más clara de las observaciones atípicas e influyentes:</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="modelos_files/figure-html/unnamed-chunk-101-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>No se observan patrones que indiquen hereroscedasticidad en los residuos (forma de cono o embudo). Se siguien observando algunas observaciones atípicas y/o influyentes.</p>
<p>Adicional, se realiza la prueba de Breusch-Pagan para verificar la homoscedasticidad de los residuales:</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>
    studentized Breusch-Pagan test

data:  reg
BP = 5.2259, df = 3, p-value = 0.156</code></pre>
</div>
</div>
<p>No se rechaza la hipótesis nula de que los errores del modelo son homoscedasticos.</p>
<p><strong><em>Multicolinealidad:</em></strong> Se verifica que las variables incluídas en el modelo no están altamente correlacionadas entre sí, y así evitar obtener resultados inestables que dificulten la interpretabilidad de los coeficientes del modelo. Se calculan los Factores de Inflación de la Varianza (VIFs):</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>  LRM_90     Edad     Sexo 
1.730823 1.035056 1.776414 </code></pre>
</div>
</div>
<p>Dado que los VIFs son mucho menores a 5, esto indica que cada variable tiene una correlación moderada (leve) con las demás. Por lo que se puede concluir que los resultados del modelo posiblemente no estarán muy afectados por la multicolinealidad.</p>
<p><strong><em>El modelo está bien especificado:</em></strong> Se hace el test de RESET para examinar si el modelo ajustado está bien especificado o si se han omitido términos no lineales o interacciones importantes:</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>
    RESET test

data:  reg
RESET = 4.1511, df1 = 4, df2 = 550, p-value = 0.00254</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
    RESET test

data:  reg
RESET = 6.8777, df1 = 2, df2 = 552, p-value = 0.001121</code></pre>
</div>
</div>
<p>En ambos casos, se rechaza la hipótesis nula de que el modelo está bien especificado.</p>
<p><strong><em>Observaciones atípicas y de alto apalancamiento:</em></strong></p>
<div>

</div>
<div class="cell quarto-layout-panel" data-layout-ncol="2">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="modelos_files/figure-html/unnamed-chunk-105-1.png" class="img-fluid" width="672"></p>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="modelos_files/figure-html/unnamed-chunk-105-2.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
<p>Usando los residuales estudentizados, se observan <span class="math inline">\(5\)</span> datos atípicos.</p>
<div>

</div>
<div class="cell quarto-layout-panel" data-layout-ncol="2">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="modelos_files/figure-html/unnamed-chunk-106-1.png" class="img-fluid" width="672"></p>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="modelos_files/figure-html/unnamed-chunk-106-2.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="quarto-layout-row">
<div class="cell-output cell-output-stdout quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<pre><code>       StudRes        Hat        CookD
80  -5.9106093 0.02989242 0.2535863431
147 -3.8402724 0.01935197 0.0709954316
552 -0.1399848 0.03225355 0.0001635637</code></pre>
</div>
</div>
</div>
<p>En total 29 observaciones superan el umbral especificado para la distancia de Cook, pero esto no significa que todas sean influyentes (alto leverage). Particularmente hay 3 observaciones que son marcadas como influyentes significativamente según la distancia de Cook. Esto indica que la inclusión de estas observaciones en el modelo pueden tener una influencia significativa en los coeficientes del modelo y en la predicción de la talla. Se debe explorar con cautela estas observaciones y decidir qué hacer con ellas.</p>
<p>Para esto, se puede comprobar el cambio en los coeficientes del modelo al excluir estas observaciones influyentes.</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = Talla ~ LRM_90 + Edad + Sexo, data = datos, subset = {
    setdiff(row(datos)[, 1], c(80, 147, 533))
})

Residuals:
     Min       1Q   Median       3Q      Max 
-11.0593  -2.3247   0.0333   2.3439   9.4841 

Coefficients:
              Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)   66.90479    3.19251  20.957  &lt; 2e-16 ***
LRM_90         2.19871    0.06392  34.400  &lt; 2e-16 ***
Edad          -0.12017    0.02297  -5.232 2.38e-07 ***
SexoMasculino  5.07314    0.41048  12.359  &lt; 2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 3.616 on 551 degrees of freedom
Multiple R-squared:  0.8561,    Adjusted R-squared:  0.8553 
F-statistic:  1093 on 3 and 551 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
<p>Las estimaciones de los coeficientes del modelo sin las obervaciones influyentes han cambiado un poco respecto al modelo original. El <span class="math inline">\(R^2\)</span> ajustado ha incrementado un poco también.</p>
</section>
</section>
<section id="modelo-lasso" class="level2">
<h2 class="anchored" data-anchor-id="modelo-lasso">Modelo Lasso</h2>
<p>En este modelo se incluirán las cuatro mediciones, con el fin de escoger la mejor. Se espera que el modelo sea capaz de inducir escasez en los coeficientes del modelo, especialmente a los correspondientes a las mediciones LRT_A, LRT_CM, LRM_90 y LRM_R, de tal manera que pueda escoger la medición que al momento de estimar la talla sea más precisa.</p>
<p>Se particionan los datos en entrenamiento y prueba,</p>
<p>Algunos coeficientes se hacen cero:</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="modelos_files/figure-html/unnamed-chunk-109-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Se hace <strong><em>k-fold cross validation</em></strong> con <span class="math inline">\(k = 10\)</span> y se promedia el MSE:</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="modelos_files/figure-html/unnamed-chunk-110-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 8.92835</code></pre>
</div>
</div>
<p>Los coeficientes del modelo resultante son:</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>                 (Intercept)                        LRT_A 
                56.786388450                  1.435775223 
                      LRT_CM                       LRM_90 
                 0.320749614                  0.000000000 
                       LRM_R                         Edad 
                 0.455791316                 -0.091366963 
                        Peso                SexoMasculino 
                 0.014799327                  2.884543834 
         EtniaBlanco-Mestizo                EtniaIndigena 
                 0.000000000                  0.007371077 
                   EtniaRrom ProgramaComunidad de Cuidado 
                 0.000000000                  0.000000000 </code></pre>
</div>
</div>
<p>y los coeficientes distintos de cero:</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>  (Intercept)         LRT_A        LRT_CM         LRM_R          Edad 
 56.786388450   1.435775223   0.320749614   0.455791316  -0.091366963 
         Peso SexoMasculino EtniaIndigena 
  0.014799327   2.884543834   0.007371077 </code></pre>
</div>
</div>
<p>Se observa que algunos coeficientes se hicieron cero, incluyendo el de LRM_90. Pero aún así el modelo todavía incluye LRT_A, LRT_CM y LRM_R al tiempo. Esto puede ser debido a que cada una de las mediciones está muy correlacionada con la talla y que además están muy correlacionadas entre ellas. Se observa que LRT_A tiene un coeficiente mucho mayor que LRT_CM y LRM_R haciendo ver que el modelo las trató de llevar a cero pero no por completo.</p>
<p>El MSE de este modelo sobre los datos de prueba fue de <span class="math inline">\(8.92\)</span>. Se puede probar aumentar el valor de <span class="math inline">\(\lambda\)</span> (sumando pequeñas cantidades al <span class="math inline">\(\lambda\)</span> que minimizó el MSE en la validación cruzada), resultará un modelo más sencillo a la vez que aumenta el MSE sobre los datos de prueba.</p>
</section>
<section id="lasso-sin-tener-en-cuenta-lrt_a" class="level2">
<h2 class="anchored" data-anchor-id="lasso-sin-tener-en-cuenta-lrt_a">Lasso sin tener en cuenta LRT_A</h2>
<p>Ya que la idea es estimar la altura de los adultos mayores usando alguno de los métodos más sencillos y accecibles para quienes toman las medidas, se excluye en este modelo LRT_A ya que es de difícil acceso y poco económico.</p>
<p>Se ajusta el modelo Lasso con las tres mediciones LRT_CM, LRM_90 y LRM_R.</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="modelos_files/figure-html/unnamed-chunk-113-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 10.30675</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>                 (Intercept)                       LRT_CM 
                57.460225737                  1.197171464 
                      LRM_90                        LRM_R 
                 0.000000000                  1.012636633 
                        Edad                         Peso 
                -0.094143416                  0.028501456 
               SexoMasculino          EtniaBlanco-Mestizo 
                 3.459993000                  0.000000000 
               EtniaIndigena                    EtniaRrom 
                 0.019471935                  0.000000000 
ProgramaComunidad de Cuidado 
                 0.004586937 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>                 (Intercept)                       LRT_CM 
                57.460225737                  1.197171464 
                       LRM_R                         Edad 
                 1.012636633                 -0.094143416 
                        Peso                SexoMasculino 
                 0.028501456                  3.459993000 
               EtniaIndigena ProgramaComunidad de Cuidado 
                 0.019471935                  0.004586937 </code></pre>
</div>
</div>
<p>El modelo sugiere incluir al tiempo LRT_CM y LRM_R. Para este modelo el MSE sobre el conjunto de test fue de <span class="math inline">\(10.30\)</span>.</p>
<p>Se ajusta el valor de <span class="math inline">\(\lambda\)</span> con el fin de llevar a cero algunos coeficientes adicionales:</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>[1] 10.37354</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>                 (Intercept)                       LRT_CM 
                 56.95226580                   1.19883570 
                      LRM_90                        LRM_R 
                  0.00000000                   1.00392104 
                        Edad                         Peso 
                 -0.07806745                   0.02427024 
               SexoMasculino          EtniaBlanco-Mestizo 
                  3.28261974                   0.00000000 
               EtniaIndigena                    EtniaRrom 
                  0.00000000                   0.00000000 
ProgramaComunidad de Cuidado 
                  0.00000000 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  (Intercept)        LRT_CM         LRM_R          Edad          Peso 
  56.95226580    1.19883570    1.00392104   -0.07806745    0.02427024 
SexoMasculino 
   3.28261974 </code></pre>
</div>
</div>
<p>Se obtiene un modelo más sencillo con un MSE de <span class="math inline">\(10.37\)</span>.</p>
</section>
<section id="modelo-lasso-1" class="level2">
<h2 class="anchored" data-anchor-id="modelo-lasso-1">Modelo Lasso</h2>
<section id="lrt-antropómetro-1" class="level3">
<h3 class="anchored" data-anchor-id="lrt-antropómetro-1">LRT Antropómetro</h3>
<p>Se particionan los datos en entrenamiento y prueba,</p>
<p>Algunos coeficientes se hacen cero:</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="modelos_files/figure-html/unnamed-chunk-116-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Se hace <strong><em>k-fold cross validation</em></strong> con <span class="math inline">\(k = 10\)</span> y se promedia el MSE:</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="modelos_files/figure-html/unnamed-chunk-117-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 9.840965</code></pre>
</div>
</div>
<p>Los coeficientes del modelo resultante son:</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>        (Intercept)               LRT_A                Edad       SexoMasculino 
       58.020781285         2.172573881        -0.094191092         2.847597629 
EtniaBlanco-Mestizo       EtniaIndigena           EtniaRrom 
        0.000000000         0.007760147         0.000000000 </code></pre>
</div>
</div>
<p>y los coeficientes distintos de cero:</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>  (Intercept)         LRT_A          Edad SexoMasculino EtniaIndigena 
 58.020781285   2.172573881  -0.094191092   2.847597629   0.007760147 </code></pre>
</div>
</div>
</section>
<section id="lrt-cinta-métrica-1" class="level3">
<h3 class="anchored" data-anchor-id="lrt-cinta-métrica-1">LRT cinta métrica</h3>
<p>Se particionan los datos en entrenamiento y prueba,</p>
<p>Algunos coeficientes se hacen cero:</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="modelos_files/figure-html/unnamed-chunk-121-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Se hace <strong><em>k-fold cross validation</em></strong> con <span class="math inline">\(k = 10\)</span> y se promedia el MSE:</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="modelos_files/figure-html/unnamed-chunk-122-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 12.85664</code></pre>
</div>
</div>
<p>Los coeficientes del modelo resultante son:</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>        (Intercept)              LRT_CM                Edad       SexoMasculino 
         56.2516018           2.1545226          -0.1207096           4.1546479 
EtniaBlanco-Mestizo       EtniaIndigena           EtniaRrom 
          0.7472236           1.1284330           0.0000000 </code></pre>
</div>
</div>
<p>y los coeficientes distintos de cero:</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>        (Intercept)              LRT_CM                Edad       SexoMasculino 
         56.2516018           2.1545226          -0.1207096           4.1546479 
EtniaBlanco-Mestizo       EtniaIndigena 
          0.7472236           1.1284330 </code></pre>
</div>
</div>
</section>
<section id="lrm-pierna-estirada-1" class="level3">
<h3 class="anchored" data-anchor-id="lrm-pierna-estirada-1">LRM pierna estirada</h3>
<p>Se particionan los datos en entrenamiento y prueba,</p>
<p>Algunos coeficientes se hacen cero:</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="modelos_files/figure-html/unnamed-chunk-126-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Se hace <strong><em>k-fold cross validation</em></strong> con <span class="math inline">\(k = 10\)</span> y se promedia el MSE:</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="modelos_files/figure-html/unnamed-chunk-127-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 11.01789</code></pre>
</div>
</div>
<p>Los coeficientes del modelo resultante son:</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>        (Intercept)               LRM_R                Edad       SexoMasculino 
         68.2658865           2.1913281          -0.1022782           3.6777167 
EtniaBlanco-Mestizo       EtniaIndigena           EtniaRrom 
          0.0000000           0.1207867           0.6724763 </code></pre>
</div>
</div>
<p>y los coeficientes distintos de cero:</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>  (Intercept)         LRM_R          Edad SexoMasculino EtniaIndigena 
   68.2658865     2.1913281    -0.1022782     3.6777167     0.1207867 
    EtniaRrom 
    0.6724763 </code></pre>
</div>
</div>
</section>
<section id="lrm-pierna-a-90-1" class="level3">
<h3 class="anchored" data-anchor-id="lrm-pierna-a-90-1">LRM pierna a 90°</h3>
<p>Se particionan los datos en entrenamiento y prueba,</p>
<p>Algunos coeficientes se hacen cero:</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="modelos_files/figure-html/unnamed-chunk-131-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Se hace <strong><em>k-fold cross validation</em></strong> con <span class="math inline">\(k = 10\)</span> y se promedia el MSE:</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="modelos_files/figure-html/unnamed-chunk-132-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 13.63767</code></pre>
</div>
</div>
<p>Los coeficientes del modelo resultante son:</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>        (Intercept)              LRM_90                Edad       SexoMasculino 
        68.88898450          2.10999429         -0.09549706          5.02553091 
EtniaBlanco-Mestizo       EtniaIndigena           EtniaRrom 
         0.02103842          0.00000000          0.47142856 </code></pre>
</div>
</div>
<p>y los coeficientes distintos de cero:</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>        (Intercept)              LRM_90                Edad       SexoMasculino 
        68.88898450          2.10999429         -0.09549706          5.02553091 
EtniaBlanco-Mestizo           EtniaRrom 
         0.02103842          0.47142856 </code></pre>
</div>
</div>
</section>
</section>
<section id="modelo-gamma" class="level2">
<h2 class="anchored" data-anchor-id="modelo-gamma">Modelo Gamma</h2>
</section>
<section id="modelo-gamma-1" class="level2">
<h2 class="anchored" data-anchor-id="modelo-gamma-1">Modelo Gamma</h2>
<section id="lrt-antropómetro-2" class="level3">
<h3 class="anchored" data-anchor-id="lrt-antropómetro-2">LRT Antropómetro</h3>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = Talla ~ LRT_A + Edad + Etnia + Sexo, family = Gamma(), 
    data = datos)

Coefficients:
                      Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)          1.046e-02  1.348e-04  77.625  &lt; 2e-16 ***
LRT_A               -8.837e-05  2.226e-06 -39.702  &lt; 2e-16 ***
Edad                 4.945e-06  8.674e-07   5.701 1.94e-08 ***
EtniaBlanco-Mestizo -1.191e-04  5.947e-05  -2.004   0.0456 *  
EtniaIndigena       -1.687e-04  7.976e-05  -2.115   0.0349 *  
EtniaRrom           -1.750e-04  1.380e-04  -1.269   0.2051    
SexoMasculino       -1.322e-04  1.635e-05  -8.090 3.81e-15 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for Gamma family taken to be 0.0004477566)

    Null deviance: 2.07361  on 557  degrees of freedom
Residual deviance: 0.24769  on 551  degrees of freedom
AIC: 2925

Number of Fisher Scoring iterations: 3</code></pre>
</div>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>Start:  AIC=4099.02
Talla ~ 1

        Df Deviance    AIC
+ LRT_A  1  0.28728 3620.5
+ Sexo   1  0.98418 3808.0
&lt;none&gt;      2.07361 4099.0
+ Etnia  3  2.05507 4100.0
+ Edad   1  2.07358 4101.0

Step:  AIC=2997.77
Talla ~ LRT_A

        Df Deviance    AIC
+ Sexo   1  0.26383 2954.2
+ Edad   1  0.27901 2983.7
&lt;none&gt;      0.28728 2997.8
+ Etnia  3  0.28578 3000.9

Step:  AIC=2952.27
Talla ~ LRT_A + Sexo

        Df Deviance    AIC
+ Edad   1  0.25000 2925.1
&lt;none&gt;      0.26383 2952.3
+ Etnia  3  0.26227 2955.0

Step:  AIC=2924.23
Talla ~ LRT_A + Sexo + Edad

        Df Deviance    AIC
&lt;none&gt;      0.25000 2924.2
+ Etnia  3  0.24769 2925.1</code></pre>
</div>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>[1] 10.97288</code></pre>
</div>
</div>
</section>
<section id="lrt-cinta-métrica-2" class="level3">
<h3 class="anchored" data-anchor-id="lrt-cinta-métrica-2">LRT cinta métrica</h3>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = Talla ~ LRT_CM + Edad + Etnia + Sexo, family = Gamma(), 
    data = datos)

Coefficients:
                      Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)          1.051e-02  1.484e-04  70.864  &lt; 2e-16 ***
LRT_CM              -8.728e-05  2.426e-06 -35.972  &lt; 2e-16 ***
Edad                 5.404e-06  9.290e-07   5.817 1.02e-08 ***
EtniaBlanco-Mestizo -1.050e-04  6.381e-05  -1.645   0.1005    
EtniaIndigena       -1.460e-04  8.558e-05  -1.706   0.0886 .  
EtniaRrom           -6.082e-05  1.482e-04  -0.410   0.6816    
SexoMasculino       -1.799e-04  1.688e-05 -10.662  &lt; 2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for Gamma family taken to be 0.0005156913)

    Null deviance: 2.07361  on 557  degrees of freedom
Residual deviance: 0.28489  on 551  degrees of freedom
AIC: 3003.1

Number of Fisher Scoring iterations: 3</code></pre>
</div>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>Start:  AIC=4099.02
Talla ~ 1

         Df Deviance    AIC
+ LRT_CM  1  0.35344 3638.3
+ Sexo    1  0.98418 3808.0
&lt;none&gt;       2.07361 4099.0
+ Etnia   3  2.05507 4100.0
+ Edad    1  2.07358 4101.0

Step:  AIC=3113.44
Talla ~ LRT_CM

        Df Deviance    AIC
+ Sexo   1  0.30348 3036.8
+ Edad   1  0.34479 3101.8
&lt;none&gt;      0.35344 3113.4
+ Etnia  3  0.35247 3117.9

Step:  AIC=3030.4
Talla ~ LRT_CM + Sexo

        Df Deviance    AIC
+ Edad   1  0.28663 3001.5
&lt;none&gt;      0.30348 3030.4
+ Etnia  3  0.30238 3034.4

Step:  AIC=3000.52
Talla ~ LRT_CM + Sexo + Edad

        Df Deviance    AIC
&lt;none&gt;      0.28663 3000.5
+ Etnia  3  0.28490 3003.2</code></pre>
</div>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>[1] 12.42458</code></pre>
</div>
</div>
</section>
<section id="lrm-pierna-estirada-2" class="level3">
<h3 class="anchored" data-anchor-id="lrm-pierna-estirada-2">LRM pierna estirada</h3>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = Talla ~ LRM_R + Edad + Etnia + Sexo, family = Gamma(), 
    data = datos)

Coefficients:
                      Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)          1.008e-02  1.440e-04  69.958  &lt; 2e-16 ***
LRM_R               -8.937e-05  2.591e-06 -34.489  &lt; 2e-16 ***
Edad                 5.173e-06  9.586e-07   5.397 1.01e-07 ***
EtniaBlanco-Mestizo -1.328e-04  6.574e-05  -2.020   0.0438 *  
EtniaIndigena       -1.800e-04  8.814e-05  -2.042   0.0416 *  
EtniaRrom           -2.386e-04  1.525e-04  -1.565   0.1182    
SexoMasculino       -1.643e-04  1.777e-05  -9.245  &lt; 2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for Gamma family taken to be 0.0005469017)

    Null deviance: 2.0736  on 557  degrees of freedom
Residual deviance: 0.3026  on 551  degrees of freedom
AIC: 3036.8

Number of Fisher Scoring iterations: 3</code></pre>
</div>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>Start:  AIC=4099.02
Talla ~ 1

        Df Deviance  AIC
+ LRM_R  1  0.35989 3640
+ Sexo   1  0.98418 3808
&lt;none&gt;      2.07361 4099
+ Etnia  3  2.05507 4100
+ Edad   1  2.07358 4101

Step:  AIC=3123.53
Talla ~ LRM_R

        Df Deviance    AIC
+ Sexo   1  0.32061 3064.8
+ Edad   1  0.35200 3113.3
&lt;none&gt;      0.35989 3123.5
+ Etnia  3  0.35782 3126.3

Step:  AIC=3061.04
Talla ~ LRM_R + Sexo

        Df Deviance    AIC
+ Edad   1  0.30556 3036.9
&lt;none&gt;      0.32061 3061.0
+ Etnia  3  0.31856 3063.5

Step:  AIC=3036.2
Talla ~ LRM_R + Sexo + Edad

        Df Deviance    AIC
&lt;none&gt;      0.30556 3036.2
+ Etnia  3  0.30260 3036.8</code></pre>
</div>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>[1] 13.31019</code></pre>
</div>
</div>
</section>
<section id="lrm-pierna-90" class="level3">
<h3 class="anchored" data-anchor-id="lrm-pierna-90">LRM pierna 90°</h3>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = Talla ~ LRM_90 + Edad + Etnia + Sexo, family = Gamma(), 
    data = datos)

Coefficients:
                      Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)          9.990e-03  1.553e-04  64.336  &lt; 2e-16 ***
LRM_90              -8.519e-05  2.736e-06 -31.132  &lt; 2e-16 ***
Edad                 4.535e-06  1.026e-06   4.420 1.19e-05 ***
EtniaBlanco-Mestizo -8.538e-05  7.022e-05  -1.216    0.225    
EtniaIndigena       -9.425e-05  9.422e-05  -1.000    0.318    
EtniaRrom           -1.644e-04  1.630e-04  -1.008    0.314    
SexoMasculino       -2.193e-04  1.815e-05 -12.086  &lt; 2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for Gamma family taken to be 0.0006248793)

    Null deviance: 2.07361  on 557  degrees of freedom
Residual deviance: 0.34805  on 551  degrees of freedom
AIC: 3114.9

Number of Fisher Scoring iterations: 3</code></pre>
</div>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>Start:  AIC=4099.02
Talla ~ 1

         Df Deviance    AIC
+ LRM_90  1  0.44295 3662.4
+ Sexo    1  0.98418 3808.0
&lt;none&gt;       2.07361 4099.0
+ Etnia   3  2.05507 4100.0
+ Edad    1  2.07358 4101.0

Step:  AIC=3239.42
Talla ~ LRM_90

        Df Deviance    AIC
+ Sexo   1  0.36092 3137.5
+ Edad   1  0.43988 3237.5
&lt;none&gt;      0.44295 3239.4
+ Etnia  3  0.44250 3244.8

Step:  AIC=3127.12
Talla ~ LRM_90 + Sexo

        Df Deviance    AIC
+ Edad   1  0.34918 3110.9
&lt;none&gt;      0.36092 3127.1
+ Etnia  3  0.36028 3132.1

Step:  AIC=3110.67
Talla ~ LRM_90 + Sexo + Edad

        Df Deviance    AIC
&lt;none&gt;      0.34918 3110.7
+ Etnia  3  0.34805 3114.9</code></pre>
</div>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>[1] 15.64766</code></pre>
</div>
</div>


</section>
</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>