train <- sample(1:nrow(x), nrow(x)*0.9) # 90% entrenamiento
test <- (-train) # 10% para prueba
y.test <- y[test]
lasso.mod <- glmnet(x[train , ], y[train], alpha = 1, lambda = grid)
plot(lasso.mod)
set.seed(123)
cv.out <- cv.glmnet(x[train, ], y[train], alpha = 1, nfolds = 10) # validación cruzada para buscar el lambda
plot(cv.out)
bestlam <- cv.out$lambda.min
lasso.pred <- predict(lasso.mod , s = bestlam, newx = x[test , ])
mean((lasso.pred - y.test)^2) # MSE sobre los datos de prueba
MSEs <- rbind(MSEs, data.frame(Modelo = "LASSO", Medida = "LRM_90", MSE = mean((lasso.pred - y.test)^2)))
out <- glmnet(x, y, alpha = 1, lambda = grid)
lasso.coef <- predict(out , type = "coefficients", s = bestlam)[1:7,]
lasso.coef
lasso.coef[lasso.coef != 0]
MSEs[1:8,]
# Modelo nulo
gamma.reg_null <- glm(Talla ~ 1, family= Gamma(),data = datos)
# Estimacion del modelo
gamma.reg <- glm(Talla ~ LRT_A + Edad + Etnia + Sexo, family= Gamma(),data = datos)
summary(gamma.reg)
stepwise <- stepAIC(gamma.reg_null, scope = list(lower = gamma.reg_null, upper = gamma.reg), trace = TRUE, k= 2, direction="forward") # k= log(nrow(datos)) - BIC
# Estimacion del modelo
gamma.final <- glm(Talla ~ LRT_A + Edad + Sexo, family= Gamma(),data = datos)
summary(gamma.final)
# k folds
best.fit <- pred <- CV.ERRORS <- cv.errors <- NULL
set.seed(123)  # Semilla para reproducibilidad
folds <- vfold_cv(datos, v = 10)
# Inicializar lista para almacenar errores
errores <- numeric(length(folds$splits))
# Loop para entrenar y validar el modelo en cada fold
for (i in seq_along(folds$splits)) {
# Dividir datos
train_data <- analysis(folds$splits[[i]])  # Datos de entrenamiento
test_data <- assessment(folds$splits[[i]]) # Datos de validación
# Ajustar el modelo
modelo <- glm(Talla ~ LRT_A + Edad + Sexo, family= Gamma(), data = train_data)
# Predicciones
predicciones <- predict(modelo, newdata = test_data, type = "response")
# Calcular error cuadrático medio
errores[i] <- mean((test_data$Talla - predicciones)^2)
}
# Error cuadratico medio
mean(errores)
MSEs <- rbind(MSEs, data.frame(Modelo = "Gamma", Medida = "LRT_A", MSE = mean(errores)))
# Modelo nulo
gamma.reg_null <- glm(Talla ~ 1, family= Gamma(),data = datos)
# Estimacion del modelo
gamma.reg <- glm(Talla ~ LRT_CM + Edad + Etnia + Sexo, family= Gamma(),data = datos)
summary(gamma.reg)
stepwise <- stepAIC(gamma.reg_null, scope = list(lower = gamma.reg_null, upper = gamma.reg), trace = TRUE, k= 2, direction="forward") # k= log(nrow(datos)) - BIC
# Estimacion del modelo
gamma.final <- glm(Talla ~ LRT_CM + Edad + Sexo, family= Gamma(),data = datos)
summary(gamma.final)
# k folds
best.fit <- pred <- CV.ERRORS <- cv.errors <- NULL
set.seed(123)  # Semilla para reproducibilidad
folds <- vfold_cv(datos, v = 10)
# Inicializar lista para almacenar errores
errores <- numeric(length(folds$splits))
# Loop para entrenar y validar el modelo en cada fold
for (i in seq_along(folds$splits)) {
# Dividir datos
train_data <- analysis(folds$splits[[i]])  # Datos de entrenamiento
test_data <- assessment(folds$splits[[i]]) # Datos de validación
# Ajustar el modelo
modelo <- glm(Talla ~ LRT_CM + Edad + Sexo, family= Gamma(), data = train_data)
# Predicciones
predicciones <- predict(modelo, newdata = test_data, type = "response")
# Calcular error cuadrático medio
errores[i] <- mean((test_data$Talla - predicciones)^2)
}
# Error cuadratico medio
mean(errores)
MSEs <- rbind(MSEs, data.frame(Modelo = "Gamma", Medida = "LRT_CM", MSE = mean(errores)))
# Modelo nulo
gamma.reg_null <- glm(Talla ~ 1, family= Gamma(),data = datos)
# Estimacion del modelo
gamma.reg <- glm(Talla ~ LRM_R + Edad + Etnia + Sexo, family= Gamma(),data = datos)
summary(gamma.reg)
stepwise <- stepAIC(gamma.reg_null, scope = list(lower = gamma.reg_null, upper = gamma.reg), trace = TRUE, k= 2, direction="forward") # k= log(nrow(datos)) - BIC
# Estimacion del modelo
gamma.final <- glm(Talla ~ LRM_R + Edad + Sexo, family= Gamma(),data = datos)
summary(gamma.final)
# k folds
best.fit <- pred <- CV.ERRORS <- cv.errors <- NULL
set.seed(123)  # Semilla para reproducibilidad
folds <- vfold_cv(datos, v = 10)
# Inicializar lista para almacenar errores
errores <- numeric(length(folds$splits))
# Loop para entrenar y validar el modelo en cada fold
for (i in seq_along(folds$splits)) {
# Dividir datos
train_data <- analysis(folds$splits[[i]])  # Datos de entrenamiento
test_data <- assessment(folds$splits[[i]]) # Datos de validación
# Ajustar el modelo
modelo <- glm(Talla ~ LRM_R + Edad + Sexo, family= Gamma(), data = train_data)
# Predicciones
predicciones <- predict(modelo, newdata = test_data, type = "response")
# Calcular error cuadrático medio
errores[i] <- mean((test_data$Talla - predicciones)^2)
}
# Error cuadratico medio
mean(errores)
MSEs <- rbind(MSEs, data.frame(Modelo = "Gamma", Medida = "LRM_R", MSE = mean(errores)))
# Modelo nulo
gamma.reg_null <- glm(Talla ~ 1, family= Gamma(),data = datos)
# Estimacion del modelo
gamma.reg <- glm(Talla ~ LRM_90 + Edad + Etnia + Sexo, family= Gamma(),data = datos)
summary(gamma.reg)
stepwise <- stepAIC(gamma.reg_null, scope = list(lower = gamma.reg_null, upper = gamma.reg), trace = TRUE, k= 2, direction="forward") # k= log(nrow(datos)) - BIC
# Estimacion del modelo
gamma.final <- glm(Talla ~ LRM_90 + Edad + Sexo, family= Gamma(),data = datos)
summary(gamma.final)
# k folds
best.fit <- pred <- CV.ERRORS <- cv.errors <- NULL
set.seed(123)  # Semilla para reproducibilidad
folds <- vfold_cv(datos, v = 10)
# Inicializar lista para almacenar errores
errores <- numeric(length(folds$splits))
# Loop para entrenar y validar el modelo en cada fold
for (i in seq_along(folds$splits)) {
# Dividir datos
train_data <- analysis(folds$splits[[i]])  # Datos de entrenamiento
test_data <- assessment(folds$splits[[i]]) # Datos de validación
# Ajustar el modelo
modelo <- glm(Talla ~ LRM_90 + Edad + Sexo, family= Gamma(), data = train_data)
# Predicciones
predicciones <- predict(modelo, newdata = test_data, type = "response")
# Calcular error cuadrático medio
errores[i] <- mean((test_data$Talla - predicciones)^2)
}
# Error cuadratico medio
mean(errores)
MSEs <- rbind(MSEs, data.frame(Modelo = "Gamma", Medida = "LRM_90", MSE = mean(errores)))
MSEs[1:12,]
# LRT_A
datos$Benjumea_LRT_A = rep(NA,nrow(datos))
# Indigena masculino
datos$Benjumea_LRT_A = ifelse(datos$Sexo=="Masculino" & datos$Etnia == "Indigena", 82.695 + 1.745*datos$LRT_A - 0.121*datos$Edad, datos$Benjumea_LRT_A)
# Indigena femenino
datos$Benjumea_LRT_A = ifelse(datos$Sexo!="Masculino" & datos$Etnia == "Indigena", 90.281 + 1.436*datos$LRT_A - 0.102*datos$Edad, datos$Benjumea_LRT_A)
# Afrodescendiente masculino
datos$Benjumea_LRT_A = ifelse(datos$Sexo=="Masculino" & datos$Etnia == "Afrocolombiano", 79.298 + 1.855*datos$LRT_A - 0.141*datos$Edad, datos$Benjumea_LRT_A)
# Afrodescendiente femenino
datos$Benjumea_LRT_A = ifelse(datos$Sexo!="Masculino" & datos$Etnia == "Afrocolombiano", 76.233 + 1.767*datos$LRT_A - 0.098*datos$Edad, datos$Benjumea_LRT_A)
# Blanco-Mestizo masculino
datos$Benjumea_LRT_A = ifelse(datos$Sexo=="Masculino" & datos$Etnia == "Blanco-Mestizo", 75.514 + 1.883*datos$LRT_A - 0.108*datos$Edad, datos$Benjumea_LRT_A)
# Blanco-Mestizo femenino
datos$Benjumea_LRT_A = ifelse(datos$Sexo!="Masculino" & datos$Etnia == "Blanco-Mestizo", 86.497 + 1.553*datos$LRT_A - 0.119*datos$Edad, datos$Benjumea_LRT_A)
mean((datos$Talla - datos$Benjumea_LRT_A)^2, na.rm = TRUE)
MSEs <- rbind(MSEs, data.frame(Modelo = "Benjumea", Medida = "LRT_A", MSE = mean((datos$Talla - datos$Benjumea_LRT_A)^2, na.rm = TRUE)))
# LRT_CM
datos$Benjumea_LRT_CM = rep(NA,nrow(datos))
# Indigena masculino
datos$Benjumea_LRT_CM = ifelse(datos$Sexo=="Masculino" & datos$Etnia == "Indigena", 82.695 + 1.745*datos$LRT_CM - 0.121*datos$Edad, datos$Benjumea_LRT_CM)
# Indigena femenino
datos$Benjumea_LRT_CM = ifelse(datos$Sexo!="Masculino" & datos$Etnia == "Indigena", 90.281 + 1.436*datos$LRT_CM - 0.102*datos$Edad, datos$Benjumea_LRT_CM)
# Afrodescendiente masculino
datos$Benjumea_LRT_CM = ifelse(datos$Sexo=="Masculino" & datos$Etnia == "Afrocolombiano", 79.298 + 1.855*datos$LRT_CM - 0.141*datos$Edad, datos$Benjumea_LRT_CM)
# Afrodescendiente femenino
datos$Benjumea_LRT_CM = ifelse(datos$Sexo!="Masculino" & datos$Etnia == "Afrocolombiano", 76.233 + 1.767*datos$LRT_CM - 0.098*datos$Edad, datos$Benjumea_LRT_CM)
# Blanco-Mestizo masculino
datos$Benjumea_LRT_CM = ifelse(datos$Sexo=="Masculino" & datos$Etnia == "Blanco-Mestizo", 75.514 + 1.883*datos$LRT_CM - 0.108*datos$Edad, datos$Benjumea_LRT_CM)
# Blanco-Mestizo femenino
datos$Benjumea_LRT_CM = ifelse(datos$Sexo!="Masculino" & datos$Etnia == "Blanco-Mestizo", 86.497 + 1.553*datos$LRT_CM - 0.119*datos$Edad, datos$Benjumea_LRT_CM)
mean((datos$Talla - datos$Benjumea_LRT_CM)^2, na.rm = TRUE)
MSEs <- rbind(MSEs, data.frame(Modelo = "Benjumea", Medida = "LRT_CM", MSE = mean((datos$Talla - datos$Benjumea_LRT_CM)^2, na.rm = TRUE)))
# LRM_R
datos$Arango_LRM_R = rep(NA,nrow(datos))
# Masculino
datos$Arango_LRM_R = ifelse(datos$Sexo=="Masculino", 119.6 + 1.121*datos$LRM_R - 0.117*datos$Edad, datos$Arango_LRM_R)
# Femenino
datos$Arango_LRM_R = ifelse(datos$Sexo!="Masculino", 107.7 + 1.263*datos$LRM_R - 0.159*datos$Edad, datos$Arango_LRM_R)
mean((datos$Talla - datos$Arango_LRM_R)^2, na.rm = TRUE)
MSEs <- rbind(MSEs, data.frame(Modelo = "Arango, Zamora", Medida = "LRT_CM", MSE = mean((datos$Talla - datos$Arango_LRM_R)^2, na.rm = TRUE)))
# LRM_90
datos$Arango_LRM_90 = rep(NA,nrow(datos))
# Masculino
datos$Arango_LRM_90 = ifelse(datos$Sexo=="Masculino", 119.6 + 1.121*datos$LRM_90 - 0.117*datos$Edad, datos$Arango_LRM_90)
# Femenino
datos$Arango_LRM_90 = ifelse(datos$Sexo!="Masculino", 107.7 + 1.263*datos$LRM_90 - 0.159*datos$Edad, datos$Arango_LRM_90)
mean((datos$Talla - datos$Arango_LRM_90)^2, na.rm = TRUE)
MSEs <- rbind(MSEs, data.frame(Modelo = "Arango, Zamora", Medida = "LRT_CM", MSE = mean((datos$Talla - datos$Arango_LRM_90)^2, na.rm = TRUE)))
MSEs
library(xtable)
install.packages("xtable")
library(xtable)
xtable(MSEs)
# Librerias
library(readxl)
library(tidyverse)
library(nortest)
library(dplyr)
library(ggplot2)
library(GGally) # para la funcion ggpairs
library(gt)
library(gtExtras)
library(moments)
library(leaps)
library(MASS)
library(lmtest)
library(car)
library(BSDA) # Test del signo
library(glmnet)
library(glmtoolbox)
library(MASS)
library(rsample)
library(lawstat)
library(symmetry)
datos <- read_excel("Datos/Corregida - COMPILADO DATOS COMUNIDAD DE CUIDADO Y CENTRO DÍA.xlsx",
range = "B2:AN561", col_types = c("date",
"skip", "text", "text", "text", "skip",
"text", "numeric", "text", "skip",
"skip", "skip", "skip", "numeric",
"skip", "skip", "skip", "skip", "numeric",
"skip", "skip", "skip", "skip", "numeric",
"skip", "skip", "skip", "skip", "numeric",
"skip", "skip", "skip", "skip", "numeric",
"skip", "skip", "skip", "skip", "numeric"))
colnames(datos) <- c("Fecha", "Localidad", "Programa", "Unidad_atencion",
"Sexo", "Edad", "Etnia", "Peso", "Talla",
"LRT_CM","LRT_A", "LRM_90","LRM_R")
datos$Sexo <- as.factor(datos$Sexo)
datos$Etnia <- as.factor(datos$Etnia)
datos <- datos[-which(datos$Edad<60),] # >60
datos <- datos |> filter(!(abs(LRT_A-LRT_CM) > 3 | abs(LRM_90-LRM_R) > 3))
datos <- datos |> as.data.frame()
boxplot(data.frame(datos$LRT_CM, datos$LRT_A), ylab = 'Longitud Rodilla - Talón (cm)', xgap.axis = c("Cinta métrica","Antropómetro"), xaxt = "n",
main = "Boxplot Longitud rodilla - talón por tipo de medición")
axis(1, at = c(1, 2), labels = c("Cinta Métrica", "Antropómetro"))
#| layout-ncol: 3
LRT_dif <- datos$LRT_CM - datos$LRT_A
hist(LRT_dif, freq = FALSE, main = 'Histograma de las la diferencias LRT_CM - LRT_A', ylab = 'Densidad', xlab = 'Diferencia (cm)')
lines(density(LRT_dif), col = "red")
abline(v = mean(LRT_dif, na.rm = TRUE), col = "red", lty = 2)
boxplot_dif <- boxplot(LRT_dif, main = "Boxplot de las diferencias LRT_CM - LRT_A")
qqnorm(LRT_dif, main = "Q-Q plot de las diferencias")
qqline(LRT_dif, col = "red")
#| layout-ncol: 3
LRT_dif <- datos$LRT_CM - datos$LRT_A
hist(LRT_dif, freq = FALSE, main = 'Histograma de las la diferencias LRT_CM - LRT_A', ylab = 'Densidad', xlab = 'Diferencia (cm)')
lines(density(LRT_dif), col = "red")
abline(v = mean(LRT_dif, na.rm = TRUE), col = "red", lty = 2)
boxplot_dif <- boxplot(LRT_dif, main = "Boxplot de las diferencias LRT_CM - LRT_A")
qqnorm(LRT_dif, main = "Q-Q plot de las diferencias")
qqline(LRT_dif, col = "red")
lLRT_A <- log(datos$LRT_A)
lLRT_CM <- log(datos$LRT_CM)
#| layout-ncol: 2
lLRT_dif <- lLRT_CM - lLRT_A
hist(lLRT_dif, freq = FALSE, main = 'Histograma de las la diferencias LRT_CM - LRT_A', ylab = 'Densidad', xlab = 'Diferencia (cm)')
lines(density(lLRT_dif), col = "red")
abline(v = mean(lLRT_dif, na.rm = TRUE), col = "red", lty = 2)
boxplot_dif <- boxplot(lLRT_dif, main = "Boxplot de las diferencias LRT_CM - LRT_A")
#| layout-ncol: 2
lLRT_dif <- lLRT_CM - lLRT_A
hist(lLRT_dif, freq = FALSE, main = 'Histograma de las la diferencias LRT_CM - LRT_A', ylab = 'Densidad', xlab = 'Diferencia (cm)')
lines(density(lLRT_dif), col = "red")
abline(v = mean(lLRT_dif, na.rm = TRUE), col = "red", lty = 2)
boxplot_dif <- boxplot(lLRT_dif, main = "Boxplot de las diferencias ln(LRT_CM) - ln(LRT_A)")
#| layout-ncol: 2
hombres <- datos[datos$Sexo == "Masculino",]
LRT_dif <- hombres$LRT_CM - hombres$LRT_A
hist(LRT_dif, freq = FALSE, main = 'Diferencia de mediciones LRT (hombres)', ylab = 'Densidad', xlab = 'Diferenencia (cm)')
lines(density(LRT_dif), col = "red")
abline(v = median(LRT_dif, na.rm = TRUE), col = "red", lty = 2)
boxplot_dif <- boxplot(LRT_dif)
#| layout-ncol: 2
hombres <- datos[datos$Sexo == "Masculino",]
LRT_dif <- hombres$LRT_CM - hombres$LRT_A
hist(LRT_dif, freq = FALSE, main = 'Diferencia de mediciones LRT (hombres)', ylab = 'Densidad', xlab = 'Diferenencia (cm)')
lines(density(LRT_dif), col = "red")
abline(v = median(LRT_dif, na.rm = TRUE), col = "red", lty = 2)
boxplot_dif <- boxplot(LRT_dif, main = "Boxplot de las diferencias LRT sexo masculino")
lLRT_A <- log(hombres$LRT_A)
lLRT_CM <- log(hombres$LRT_CM)
#| layout-ncol: 2
lLRT_dif <- lLRT_CM - lLRT_A
hist(lLRT_dif, freq = FALSE, main = 'Histograma de las la diferencias LRT_CM - LRT_A', ylab = 'Densidad', xlab = 'Diferencia (cm)')
lines(density(lLRT_dif), col = "red")
abline(v = mean(lLRT_dif, na.rm = TRUE), col = "red", lty = 2)
boxplot_dif <- boxplot(lLRT_dif, main = "Boxplot de las diferencias ln(LRT) sexo masculino")
#| layout-ncol: 2
# Diferencias CM y A
mujeres <- datos[datos$Sexo == "Femenino",]
LRT_dif <- mujeres$LRT_CM - mujeres$LRT_A
# Como se ve graficamente, parece que no hay normalidad
hist(LRT_dif, freq = FALSE, main = 'Diferencia de mediciones LRT (mujeres)', ylab = 'Densidad', xlab = 'Diferenencia (cm)')
lines(density(LRT_dif), col = "red")
abline(v = median(LRT_dif, na.rm = TRUE), col = "red", lty = 2)
boxplot_dif <- boxplot(LRT_dif, main = "Boxplot diferencia LRT sexo femenino") # hay muchos outliers
#| layout-ncol: 2
# Diferencias CM y A
bm <- datos[datos$Etnia=="Blanco-Mestizo",]
LRT_dif <- bm$LRT_CM - bm$LRT_A
# Como se ve graficamente, parece que no hay normalidad
hist(LRT_dif, freq = FALSE, main = 'Histograma de las la diferencia de mediciones LRT', ylab = 'Densidad', xlab = 'Diferenencia (cm)')
lines(density(LRT_dif), col = "red")
abline(v = median(LRT_dif, na.rm = TRUE), col = "red", lty = 2)
boxplot_dif <- boxplot(LRT_dif) # hay muchos outliers
#| layout-ncol: 2
# Diferencias CM y A
bm <- datos[datos$Etnia=="Blanco-Mestizo",]
LRT_dif <- bm$LRT_CM - bm$LRT_A
# Como se ve graficamente, parece que no hay normalidad
hist(LRT_dif, freq = FALSE, main = 'Histograma de las la diferencia de mediciones LRT', ylab = 'Densidad', xlab = 'Diferenencia (cm)')
lines(density(LRT_dif), col = "red")
abline(v = median(LRT_dif, na.rm = TRUE), col = "red", lty = 2)
boxplot_dif <- boxplot(LRT_dif, main = "Boxplot diferencias LRT etnia Blanco-Mestizo") # hay muchos outliers
lLRT_A <- log(bm$LRT_A)
lLRT_CM <- log(bm$LRT_CM)
#| layout-ncol: 2
lLRT_dif <- lLRT_CM - lLRT_A
hist(lLRT_dif, freq = FALSE, main = 'Histograma de las la diferencias LRT_CM - LRT_A', ylab = 'Densidad', xlab = 'Diferencia (cm)')
lines(density(lLRT_dif), col = "red")
abline(v = mean(lLRT_dif, na.rm = TRUE), col = "red", lty = 2)
boxplot_dif <- boxplot(lLRT_dif, main = "Boxplot de las diferencias LRT_CM - LRT_A")
#| layout-ncol: 2
lLRT_dif <- lLRT_CM - lLRT_A
hist(lLRT_dif, freq = FALSE, main = 'Histograma de las la diferencias LRT_CM - LRT_A', ylab = 'Densidad', xlab = 'Diferencia (cm)')
lines(density(lLRT_dif), col = "red")
abline(v = mean(lLRT_dif, na.rm = TRUE), col = "red", lty = 2)
boxplot_dif <- boxplot(lLRT_dif, main = "Boxplot de las diferencias ln(LRT) etnia Blanco-Mestizo")
lLRT_A <- log(bm$LRT_A)
lLRT_CM <- log(bm$LRT_CM)
#| layout-ncol: 2
lLRT_dif <- lLRT_CM - lLRT_A
hist(lLRT_dif, freq = FALSE, main = 'Histograma de las la diferencias LRT_CM - LRT_A', ylab = 'Densidad', xlab = 'Diferencia (cm)')
lines(density(lLRT_dif), col = "red")
abline(v = mean(lLRT_dif, na.rm = TRUE), col = "red", lty = 2)
boxplot_dif <- boxplot(lLRT_dif, main = "Boxplot de las diferencias ln(LRT) etnia Blanco-Mestizo")
#| layout-ncol: 2
# Diferencias CM y A
nobm <- datos[datos$Etnia!="Blanco-Mestizo",]
LRT_dif <- nobm$LRT_CM - nobm$LRT_A
#length(LRT_dif)
# Como se ve graficamente, parece que no hay normalidad
hist(LRT_dif, freq = FALSE, main = 'Histograma de las la diferencia de mediciones LRT', ylab = 'Densidad', xlab = 'Diferenencia (cm)')
lines(density(LRT_dif), col = "red")
abline(v = median(LRT_dif, na.rm = TRUE), col = "red", lty = 2)
boxplot_dif <- boxplot(LRT_dif) # No hay outliers
#| layout-ncol: 2
# Diferencias CM y A
nobm <- datos[datos$Etnia!="Blanco-Mestizo",]
LRT_dif <- nobm$LRT_CM - nobm$LRT_A
#length(LRT_dif)
# Como se ve graficamente, parece que no hay normalidad
hist(LRT_dif, freq = FALSE, main = 'Histograma de las la diferencia de mediciones LRT', ylab = 'Densidad', xlab = 'Diferenencia (cm)')
lines(density(LRT_dif), col = "red")
abline(v = median(LRT_dif, na.rm = TRUE), col = "red", lty = 2)
boxplot_dif <- boxplot(LRT_dif, main = "Boxplot diferencias LRT etnia NO Blanco-Mestizo") # No hay outliers
# Comparar LRM 90 y R
boxplot(data.frame(datos$LRM_90, datos$LRM_R), ylab = 'Longitud Rodilla-Maleolo (cm)', xaxt = "n")
axis(1, at = c(1, 2),
labels = c("Pierna a 90°", "Pierna recta"))
# Comparar LRM 90 y R
boxplot(data.frame(datos$LRM_90, datos$LRM_R), ylab = 'Longitud Rodilla-Maleolo (cm)', xaxt = "n", main = "Boxplot Longitud rodilla-maléolo por tipo de medición")
axis(1, at = c(1, 2),
labels = c("Pierna a 90°", "Pierna recta"))
# Diferencias CM y A
LRM_dif <- datos$LRM_90 - datos$LRM_R
# Como se ve graficamente, parece que no hay normalidad
par(mfrow=c(1,2))
hist(LRM_dif, freq = FALSE, main = 'Histograma de las la diferencia de mediciones LRT', ylab = 'Densidad', xlab = 'Diferenencia (cm)')
lines(density(LRM_dif), col = "red")
abline(v = median(LRM_dif, na.rm = TRUE), col = "red", lty = 2)
boxplot_dif <- boxplot(LRM_dif) # hay muchos outliers
# Diferencias CM y A
LRM_dif <- datos$LRM_90 - datos$LRM_R
# Como se ve graficamente, parece que no hay normalidad
hist(LRM_dif, freq = FALSE, main = 'Histograma de las la diferencia de mediciones LRT', ylab = 'Densidad', xlab = 'Diferenencia (cm)')
lines(density(LRM_dif), col = "red")
abline(v = median(LRM_dif, na.rm = TRUE), col = "red", lty = 2)
boxplot_dif <- boxplot(LRM_dif) # hay muchos outliers
par(mfrow=c(1,1))
# Diferencias CM y A
LRM_dif <- datos$LRM_90 - datos$LRM_R
# Como se ve graficamente, parece que no hay normalidad
hist(LRM_dif, freq = FALSE, main = 'Histograma de las la diferencia de mediciones LRT', ylab = 'Densidad', xlab = 'Diferenencia (cm)')
lines(density(LRM_dif), col = "red")
abline(v = median(LRM_dif, na.rm = TRUE), col = "red", lty = 2)
boxplot_dif <- boxplot(LRM_dif) # hay muchos outliers
# Diferencias CM y A
LRM_dif <- datos$LRM_90 - datos$LRM_R
# Como se ve graficamente, parece que no hay normalidad
hist(LRM_dif, freq = FALSE, main = 'Histograma de las la diferencia de mediciones LRM', ylab = 'Densidad', xlab = 'Diferenencia (cm)')
lines(density(LRM_dif), col = "red")
abline(v = median(LRM_dif, na.rm = TRUE), col = "red", lty = 2)
boxplot_dif <- boxplot(LRM_dif) # hay muchos outliers
# Diferencias CM y A
LRM_dif <- datos$LRM_90 - datos$LRM_R
# Como se ve graficamente, parece que no hay normalidad
hist(LRM_dif, freq = FALSE, main = 'Histograma de las diferencias de mediciones LRM', ylab = 'Densidad', xlab = 'Diferenencia (cm)')
lines(density(LRM_dif), col = "red")
abline(v = median(LRM_dif, na.rm = TRUE), col = "red", lty = 2)
boxplot_dif <- boxplot(LRM_dif, main = "Boxplot de las diferencias ln(LRM)") # hay muchos outliers
# Diferencias CM y A
LRM_dif <- datos$LRM_90 - datos$LRM_R
# Como se ve graficamente, parece que no hay normalidad
hist(LRM_dif, freq = FALSE, main = 'Histograma de las diferencias de mediciones LRM', ylab = 'Densidad', xlab = 'Diferenencia (cm)')
lines(density(LRM_dif), col = "red")
abline(v = median(LRM_dif, na.rm = TRUE), col = "red", lty = 2)
boxplot_dif <- boxplot(LRM_dif, main = "Boxplot de las diferencias LRM") # hay muchos outliers
#| layout-ncol: 3
LRM_dif <- datos$LRM_90 - datos$LRM_R
hist(LRM_dif, freq = FALSE, main = 'Histograma de las la diferencias LRM_90 - LRT_A', ylab = 'Densidad', xlab = 'Diferencia (cm)')
lines(density(LRM_dif), col = "red")
abline(v = mean(LRM_dif, na.rm = TRUE), col = "red", lty = 2)
boxplot_dif <- boxplot(LRM_dif, main = "Boxplot de las diferencias LRM_90 - LRT_A")
qqnorm(LRM_dif, main = "Q-Q plot de las diferencias")
qqline(LRM_dif, col = "red")
lLRM_R <- log(datos$LRM_R)
lLRM_90 <- log(datos$LRM_90)
#| layout-ncol: 2
lLRM_dif <- lLRM_90 - lLRM_R
hist(lLRM_dif, freq = FALSE, main = 'Histograma de las la diferencias LRM_90 - LRM_R', ylab = 'Densidad', xlab = 'Diferencia (cm)')
lines(density(lLRM_dif), col = "red")
abline(v = mean(lLRM_dif, na.rm = TRUE), col = "red", lty = 2)
boxplot_dif <- boxplot(lLRM_dif, main = "Boxplot de las diferencias LRM_90 - LRM_R")
#| layout-ncol: 2
lLRM_dif <- lLRM_90 - lLRM_R
hist(lLRM_dif, freq = FALSE, main = 'Histograma de las la diferencias LRM_90 - LRM_R', ylab = 'Densidad', xlab = 'Diferencia (cm)')
lines(density(lLRM_dif), col = "red")
abline(v = mean(lLRM_dif, na.rm = TRUE), col = "red", lty = 2)
boxplot_dif <- boxplot(lLRM_dif, main = "Boxplot de las diferencias ln(LRM)")
#| layout-ncol: 2
hombres <- datos[datos$Sexo == "Masculino",]
LRM_dif <- hombres$LRM_90 - hombres$LRM_R
hist(LRM_dif, freq = FALSE, main = 'Diferencia de mediciones LRT (hombres)', ylab = 'Densidad', xlab = 'Diferenencia (cm)')
lines(density(LRM_dif), col = "red")
abline(v = median(LRM_dif, na.rm = TRUE), col = "red", lty = 2)
boxplot_dif <- boxplot(LRM_dif)
#| layout-ncol: 2
hombres <- datos[datos$Sexo == "Masculino",]
LRM_dif <- hombres$LRM_90 - hombres$LRM_R
hist(LRM_dif, freq = FALSE, main = 'Diferencia de mediciones LRT (hombres)', ylab = 'Densidad', xlab = 'Diferenencia (cm)')
lines(density(LRM_dif), col = "red")
abline(v = median(LRM_dif, na.rm = TRUE), col = "red", lty = 2)
boxplot_dif <- boxplot(LRM_dif, main = "Boxplot diferencias LRM sexo masculino")
#| layout-ncol: 2
# Diferencias CM y A
mujeres <- datos[datos$Sexo == "Femenino",]
LRM_dif <- mujeres$LRM_90 - mujeres$LRM_R
# Como se ve graficamente, parece que no hay normalidad
hist(LRM_dif, freq = FALSE, main = 'Diferencia de mediciones LRT (mujeres)', ylab = 'Densidad', xlab = 'Diferenencia (cm)')
lines(density(LRM_dif), col = "red")
abline(v = median(LRM_dif, na.rm = TRUE), col = "red", lty = 2)
boxplot_dif <- boxplot(LRM_dif) # hay muchos outliers
#| layout-ncol: 2
# Diferencias CM y A
mujeres <- datos[datos$Sexo == "Femenino",]
LRM_dif <- mujeres$LRM_90 - mujeres$LRM_R
# Como se ve graficamente, parece que no hay normalidad
hist(LRM_dif, freq = FALSE, main = 'Diferencia de mediciones LRT (mujeres)', ylab = 'Densidad', xlab = 'Diferenencia (cm)')
lines(density(LRM_dif), col = "red")
abline(v = median(LRM_dif, na.rm = TRUE), col = "red", lty = 2)
boxplot_dif <- boxplot(LRM_dif, main = "Boxplot diferencia LRM sexo femenino") # hay muchos outliers
#| layout-ncol: 2
# Diferencias CM y A
bm <- datos[datos$Etnia=="Blanco-Mestizo",]
LRM_dif <- bm$LRM_90 - bm$LRM_R
# Como se ve graficamente, parece que no hay normalidad
hist(LRM_dif, freq = FALSE, main = 'Histograma de las la diferencia de mediciones LRT', ylab = 'Densidad', xlab = 'Diferenencia (cm)')
lines(density(LRM_dif), col = "red")
abline(v = median(LRM_dif, na.rm = TRUE), col = "red", lty = 2)
boxplot_dif <- boxplot(LRM_dif) # hay muchos outliers
#| layout-ncol: 2
# Diferencias CM y A
bm <- datos[datos$Etnia=="Blanco-Mestizo",]
LRM_dif <- bm$LRM_90 - bm$LRM_R
# Como se ve graficamente, parece que no hay normalidad
hist(LRM_dif, freq = FALSE, main = 'Histograma de las la diferencia de mediciones LRT', ylab = 'Densidad', xlab = 'Diferenencia (cm)')
lines(density(LRM_dif), col = "red")
abline(v = median(LRM_dif, na.rm = TRUE), col = "red", lty = 2)
boxplot_dif <- boxplot(LRM_dif, main = "Boxplot diferencias LRM etnia Blanco-Mestizo") # hay muchos outliers
lLRM_R <- log(bm$LRM_R)
lLRM_90 <- log(bm$LRM_90)
#| layout-ncol: 2
lLRM_dif <- lLRM_90 - lLRM_R
hist(lLRM_dif, freq = FALSE, main = 'Histograma de las la diferencias LRM_90 - LRM_R', ylab = 'Densidad', xlab = 'Diferencia (cm)')
lines(density(lLRM_dif), col = "red")
abline(v = mean(lLRM_dif, na.rm = TRUE), col = "red", lty = 2)
boxplot_dif <- boxplot(lLRM_dif, main = "Boxplot de las diferencias LRM_90 - LRM_R")
#| layout-ncol: 2
lLRM_dif <- lLRM_90 - lLRM_R
hist(lLRM_dif, freq = FALSE, main = 'Histograma de las la diferencias LRM_90 - LRM_R', ylab = 'Densidad', xlab = 'Diferencia (cm)')
lines(density(lLRM_dif), col = "red")
abline(v = mean(lLRM_dif, na.rm = TRUE), col = "red", lty = 2)
boxplot_dif <- boxplot(lLRM_dif, main = "Boxplot de las diferencias ln(LRM) etnia Blanco-Mestizo")
#| layout-ncol: 2
# Diferencias CM y A
nobm <- datos[datos$Etnia!="Blanco-Mestizo",]
LRM_dif <- nobm$LRM_90 - nobm$LRM_R
#length(LRM_dif)
# Como se ve graficamente, parece que no hay normalidad
hist(LRM_dif, freq = FALSE, main = 'Histograma de las la diferencia de mediciones LRT', ylab = 'Densidad', xlab = 'Diferenencia (cm)')
lines(density(LRM_dif), col = "red")
abline(v = median(LRM_dif, na.rm = TRUE), col = "red", lty = 2)
boxplot_dif <- boxplot(LRM_dif) # No hay outliers
#| layout-ncol: 2
# Diferencias CM y A
nobm <- datos[datos$Etnia!="Blanco-Mestizo",]
LRM_dif <- nobm$LRM_90 - nobm$LRM_R
#length(LRM_dif)
# Como se ve graficamente, parece que no hay normalidad
hist(LRM_dif, freq = FALSE, main = 'Histograma de las la diferencia de mediciones LRT', ylab = 'Densidad', xlab = 'Diferenencia (cm)')
lines(density(LRM_dif), col = "red")
abline(v = median(LRM_dif, na.rm = TRUE), col = "red", lty = 2)
boxplot_dif <- boxplot(LRM_dif, main = "Boxplot diferencias LRM etnia No Blanco-Mestizo") # No hay outliers
